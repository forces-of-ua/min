function setIE6iframeSrc(a){return browserInfo.isIE6&&baseUrl.indexOf("https://")>-1?a?'src="'+dummyImgForIframe+'"':dummyImgForIframe:""}function saveGridTabIndex(a,b,c,d){this.name=a,this.rows=b,this.cells=c,this.lastIndex=d}function collapsToolBar(a,b){if(null!=b&&""!=b&&null!=$(b)){var c=$(b);a="object"==typeof a?a:null!=a&&""!=a?$(a):null;var d;"none"==c.style.display?(c.style.display="",d=!0):(c.style.display="none",d=!1),null!=a&&(a.className=d?"tb_collaps_off":"tb_collaps_on");for(var e in toolbarZones)if("undefined"!=typeof toolbarZones[e]&&null!=toolbarZones[e]){var f=toolbarZones[e];f.id==b&&f.display!=d&&setDisplay(f,d)}self.parent==self&&saveToolbarZonesToCookie()}}function toolbarZone(a,b,c){this.id=a,this.img=b,this.display=c}function setDisplay(a,b){null!=a&&"object"==typeof a&&"undefined"!=typeof a.display&&null!=a.display&&(a.display=b)}function saveToolbarZonesToCookie(){for(var a in toolbarZones)if("undefined"!=typeof toolbarZones[a]&&null!=toolbarZones[a]){var b=toolbarZones[a];b.display?clearCookie(b.id,"hidden"):setCookie(b.id,"hidden")}}function getToolbarZonesFromCookie(){var a=null,b="";for(var c in toolbarZones)"undefined"!=typeof toolbarZones[c]&&null!=toolbarZones[c]&&(a=toolbarZones[c],b=getCookie(a.id),null!=b&&(setDisplay(a,!1),collapsToolBar(a.img,a.id)))}function addWin(a,b,c){var d=winArray.length;return winArray[d]=a,winAttrArray[d]=b,winClassArray[d]=null==c?"":c,d}function getWinAttr(a,b){for(var c=!1,d=0;d<winArray.length;d++)if(winArray[d]==a&&!winArray[d].closed){if("undefined"!=typeof b&&null!=b&&""!=b&&winClassArray[d]!=b)continue;c=!0;break}return c?winAttrArray[d]:null}function addUpdateFrameFunction(a,b){try{updateFrameFunctionArray[a]=b}catch(a){}}function getUpdateFrameFunction(a){try{return updateFrameFunctionArray[a]}catch(a){}}function delUpdateFrameFunction(a){try{a&&(updateFrameFunctionArray[a]=null)}catch(a){}}function setBaseUrl(a){baseUrl=a}function getBaseUrl(){return null==baseUrl?document.getElementsByTagName("base")[0].href:baseUrl}function setPopupWinWidth(a){popupWinWidth=a}function setPopupWinHeight(a){popupWinHeight=a}function getPopupWinWidth(){return popupWinWidth||0==popupWinWidth?popupWinWidth:750}function getPopupWinHeight(){return popupWinHeight||0==popupWinHeight?popupWinHeight:550}function trim(a){var b="";return null!=a?a.replace(/^\s\s*/,b).replace(/\s\s*$/,b):a}function replaceSubstring(a,b,c){if(null==a)return"";if(null==b||""==b)return a;null==c&&(c="");var d=a.split(b);return a=d.join(c)}function findPos(a,b,c){var f,g,d=0,e=0;if(f=null!=c?c:document.getElementById(a),f.offsetParent)for(g=f;g.offsetParent;)g=g.offsetParent,d+=g.offsetLeft,e+=g.offsetTop;return d+=f.offsetLeft,e+=f.offsetTop+b,[d,e]}function changeLinksToUTF8(){for(var a=document.getElementsByTagName("a"),b=0;b<a.length;b++){var c=a[b],d=c.getAttribute("href");d=encodeURI(d),c.setAttribute("href",d)}}function getObjById(a,b){if(null==a)return null;if(""==trim(a))return null;var c=null!=b?b:window,d=c.document.getElementById(a);return null!=d?d:d=c.document.getElementsByName(a)[0]}function getObjectByAttr(a,b,c,d,e){if(null==a)return null;if(null==b||null!=b&&""==trim(b))return null;if(null==c||null!=c&&""==trim(c))return null;if(null==d)return null;"class"!=c&&"className"!=c||(c=isIE?"className":"class");for(var f=new Array,g=0;obj=a.getElementsByTagName(b).item(g);g++){var h=obj.getAttribute(c);if(null!=h&&h==d&&(f[f.length]=obj,e))return f}return 0==f.length?null:f}function getFalse(a){var a=window.event?window.event:null==a?null:a;return null!=a&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()),!1}function contains(a,b,c){if(null==a)return!!c&&-1;for(var d=0;d<a.length;d++)if(a[d]==b)return!c||d;return!!c&&-1}function isElemInArray(arr,attrName,attrValue,mode){if(null==arr)return null;for(var i=0;i<arr.length;i++){var item=arr[i];if("object"==typeof item){var attr=eval("item."+attrName);if(null!=attr&&attr==attrValue)switch(mode){case 1:return i;case 2:return item;default:return!0}}}switch(mode){case 1:return-1;case 2:return null;default:return!1}}function push(a){if(void 0!=a)return this[this.length]=a,this[this.length-1]}function pop(a){if("undefined"==typeof a){var a=this[this.length-1];return this[this.length-1]=null,this.length--,a}var b=this.length,c=0;for(i=0;i<b;i++)this[i]!=a&&(this[c]=this[i],c++);this.length--}function getFirstChildTag(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(null!=c&&c.tagName)return c}return null}function getPrevSiblingTag(a,b){var c=null!=b&&"undefined"!=typeof b?parseInt(b):0;isNaN(c)&&(c=0),c<0&&(c=0);for(var d=a;d;)if(d=d.previousSibling,d&&d.tagName){if(0==c)return d;c-=1}return null}function getNextSiblingTag(a,b){var c=null!=b&&"undefined"!=typeof b?parseInt(b):0;isNaN(c)&&(c=0),c<0&&(c=0);for(var d=a;d;)if(d=d.nextSibling,d&&d.tagName){if(0==c)return d;c-=1}return null}function getElementByClassName(a,b){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.tagName){if(d.className==b)return d;if(d=getElementByClassName(d,b),null!=d)return d}}return null}function getParentByClassName(a,b){if(!a)return null;var c=a.parentNode;return c?c.className==b?c:getParentByClassName(c,b):null}function getParentByTagName(a,b){if(null==a)return null;b=null!=b?b.toLocaleUpperCase():b;for(var c=null,d=null,e=a;c=e.parentNode;){if(1==c.nodeType&&(null==b||c.tagName.toLocaleUpperCase()==b)){d=c;break}e=c}return d}function getPrevSiblingByClassName(a,b){for(var c=a;c;){if(c.className==b)return c;c=c.previousSibling}return null}function getNextSiblingByClassName(a,b){for(var c=a;c;){if(c.className==b)return c;c=c.nextSibling}return null}function ReplaceTags(a){return a=a.replace(/<\/?[^>]+>/gi,"")}function getInnerText(a){var b="";return b=a.innerText?a.innerText:ReplaceTags(a.innerHTML)}function getOuterHTML(a){var b="";if(a.outerHTML)b=a.outerHTML;else{for(var c=a.parentNode,d=c.cloneNode(!0),e=d.childNodes.length-1;0!=e;){var f=d.childNodes[e];1!=f.nodeType?d.removeChild(f):f.getAttribute("id")!=a.getAttribute("id")&&d.removeChild(f),e--}b=d.innerHTML}return b}function setOuterHTML(a,b){if(a){if(a.outerHTML)return void(a.outerHTML=b);var c=document.createElement("span");c.innerHTML=b;var d=a.parentNode;d.replaceChild(c,a)}}function emulate_insertAdjacentHTML(){"undefined"==typeof HTMLElement||HTMLElement.prototype.insertAdjacentElement||(HTMLElement.prototype.insertAdjacentElement=function(a,b){switch(a){case"beforeBegin":this.parentNode.insertBefore(b,this);break;case"afterBegin":this.insertBefore(b,this.firstChild);break;case"beforeEnd":this.appendChild(b);break;case"afterEnd":this.nextSibling?this.parentNode.insertBefore(b,this.nextSibling):this.parentNode.appendChild(b)}},HTMLElement.prototype.insertAdjacentHTML=function(a,b){var c=this.ownerDocument.createRange();c.setStartBefore(this);var d=c.createContextualFragment(b);this.insertAdjacentElement(a,d)})}function emptyTagInnerHTML(a){if(null==a)return null;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)if("TBODY"==c.tagName.toUpperCase()){var d=emptyTagInnerHTML(c);if(!d)return!1}else if("SCRIPT"!=c.tagName.toUpperCase())return!1;if(3==c.nodeType){var e=trim(c.nodeValue);if(""==e||e.indexOf("&nbsp")&&e.length<=6)continue;return!0}}return!0}function er_invert(a){var b=getObjById(a);b&&(b.style.display="block"!=b.style.display?"block":"none")}function newImg(a,b){if(b){var c;if(1!=a.nodeType){c=a.parentNode;for(var d=c.childNodes,e=0;e<d.length;e++)if(1==d[e].nodeType&&"IMG"==d[e].tagName){a=d[e];break}}a.src=b.src}}function getForm(a){if(!a)return document.forms[document.forms.length-1];for(var b=a.parentNode;"FORM"!=b.tagName&&null!=b.parentNode;)b=b.parentNode;return"FORM"!=b.tagName?null:b}function getFrame(a,b){for(var c=0;c<a.frames.length;c++)if(a.frames[c].name==b)return a.frames[c];return null}function getIframeWindow(a){return a?a.contentDocument?a.contentDocument:a.contentWindow:null}function url(a,b,c){a=(a.indexOf("://")<0?baseUrl:"")+a.replace("#","%23");var d=null,e=null;if(!b||"_blank"==b)return doOpenWindow(a);if("_self"==b)d=self;else{if(e=getFrame(self,b),e||(e=getFrame(self.parent,b),e||(e=getFrame(top,b))),!e)return doOpenWindow(a);d=e.length>0?e[0]:e}if(d){var f=d.location?d:getIframeWindow(d);null!=c&&c?f.location.replace(a):f.location.href=a}else alert("Frame "+b+" does not exists.");return d}function addToTitle(a,b){var c=a.split("&#034;");a=c.join('"'),c=a.split("&#039;"),a=c.join("'");var d=null==self.parent||self.parent==self?self.document:self.parent.document,e="";switch(b){case"rewrite":e=a;break;case"append":e=d.title+a;break;default:var f=d.title.indexOf("(");f>=0&&(d.title=d.title.substring(0,f-1)),e="( "+a+" ) "+d.title}d.title=e}function refreshPage(){var a=!0;self.parent?(a=!self.parent.getChanged||"true"!=self.parent.getChanged(),a&&(self.parent.list?self.parent.list.location.reload(!0):self.parent.location.reload(!0))):(a=!self.getChanged||"true"!=getChanged(),a&&self.location.reload(!0))}function updatePage(){self.parent?self.parent.list&&self.parent.list.refreshWin?self.parent.list.refreshWin():self.parent.refreshWin&&self.parent.refreshWin():self.refreshWin&&self.refreshWin()}function updateFrame(a){var b=a&&a.location?a:self;if(b.refreshWin)b.refreshWin();else{var c=!b.getChanged||"true"!=b.getChanged();if(c){var d=b.location.href;b.location.href=d}}}function clearSelectedObjBar(){var a=getListFrame();if(a||(a=self),a.clearSelectedInList){var b=selectCheckersName;a.clearSelectedInList(b)}}function checkNavigator(a,b,c){for(var e,d=document.getElementsByTagName(a),f=0;f<d.length;f++)if(e="class"!=b?d[f].getAttribute(b):d[f].className,e==c)return!0;return!1}function getListFrame(a){var b=self.parent&&self.parent!=self&&self.parent.frames?self.parent:self;return a?getFrame(b,a):getFrame(b,"list")}function makeInput(a,b,c,d){if(!c||""==c)return null;a.innerHTML+="<INPUT type="+b+' name="'+c+'" />';var e=null,f=a.elements[c];return f?(e=f.length&&f.length>1?f.item(f.length-1):f,e.setAttribute("id",c),e.value=d,e):null}function addInput(a,b,c,d){var e=document.createElement("INPUT");e.setAttribute("TYPE","hidden"),e.setAttribute("NAME",b),d&&e.setAttribute("id",b),e.value=c,a.appendChild(e)}function makeForm(a,b,c,d,e,f,g){var h=null;if(h=document.forms[a]){for(var i=0;0!=h.elements.length;)h.removeChild(h.elements[i]),i++;return h}var j=document.getElementsByTagName("body").item(0);if(!j||!a)return null;var k=document.createElement("FORM");return k.method=e?e:"POST",d&&(k.target=d),c&&(k.setAttribute("ACTION",c),k.action=c),k.setAttribute("enctype","multipart/form-data"),k.setAttribute("encoding","multipart/form-data"),k.name=a,k.setAttribute("id",b?b:a),k.className=f?f:"virtual",g||(k.style.display="none"),j.appendChild(k),k}function makeIframe(a,b,c,d,e,f){c=c?c:b;var g=$(c);if(g)return g;if(g=getFrame(window,b))return g;if(!a){var h=document.getElementsByTagName("body");if(!h||0==h.length)return null;a=h.item(0)}d=d?d:"virtual";var i=e&&""!=e?" style='"+e+"'":"",j=f&&""!=f?" src='"+f+"' ":setIE6iframeSrc(!0);"undefined"==typeof a.insertAdjacentHTML&&emulate_insertAdjacentHTML();try{a.insertAdjacentHTML("afterBegin","<iframe "+j+" id='"+c+"' name='"+b+"' class='"+d+"' "+i+" ></iframe>")}catch(a){return null}return(g=$(c))?g:(g=getFrame(window,b))?g:null}function getIndexByOptionValue(a,b,c){for(var d=0,e="",f=0;f<a.length;f++)if(e=a.options[f].value,e==b||c&&e.indexOf(b)!=-1){d=f;break}return d}function addOption(a,b,c,d,e){var f="true";if(!e)for(var g=0;g<a.length;g++)a.options[g].value==b&&(f="false");if("true"==f){var h=document.createElement("OPTION");h.text=c,null!=b&&""!=b&&(h.value=b),null!=d&&""!=d&&(h.data=d),a.options.add?a.options.add(h):a.add(h,null)}}function delOption(a,b,c){var d=parseInt(b);if(isNaN(d)||d<0){if(!c)return;d=getIndexByOptionValue(a,c)}d>-1&&(a.options[d]=null)}function moveHorizontal(a,b,c,d){var e=$(c?a:b),f=$(c?b:a);if(e&&f){for(var g,h,i,j=0;j<e.length;j++)i=e.options[j],g=!!d||i.selected,g&&addOption(f,i.value,i.text,i.data);for(var j=e.length-1;j>=0;j--)i=e.options[j],h=!!d||i.selected,h&&delOption(e,j)}}function ToHidden(a,b,c){if(c){var d=c.parentNode;gridToHidden(b,d)}else for(b.value="",i=0;i<a.options.length;i++)b.value=b.value+a.options[i].value+","}function gridToHidden(a,b){if(b&&a){a.value="";for(var c=0;c<b.childNodes.length;c++)"#"!=b.childNodes[c].nodeName[0]&&null!=b.childNodes[c].getAttribute("objId")&&(a.value+=",",a.value=a.value+b.childNodes[c].getAttribute("objId"))}}function setCheckBox(a,b,c,d,e){var f="string"==typeof d?$(d):d;f||"string"!=typeof d||(f=document.forms[d]),f||(f=document.forms[document.forms.length-1]);var g=f[a];g&&(g.checked=c,c?g.setAttribute("checked",c):g.removeAttribute("checked"));var h=f[b];h&&(h.value=c),null!=e&&(c?f[e].removeAttribute("disabled"):f[e].setAttribute("disabled","true"))}function setEventsToButtons(a){for(var b=null,c=0;c<document.links.length;c++)b=document.links[c].parentNode,b.className==a&&(b=document.links[c],b.onmouseover=new Function("this.parentNode.style.paddingTop='';this.parentNode.className = 'menuL_over';"),b.onmouseout=new Function("this.parentNode.className = 'menuL';"));for(var d=null,e=0;d=document.getElementsByTagName("button")[e];e++)b=d.parentNode,b.className==a&&(d.onmouseover=new Function("this.parentNode.className = 'menu_over';"),d.onmouseout=new Function("this.parentNode.className = 'menu';"))}function checkinteger(a){return 0==a.length||a.match("^([-]){0,1}([0-9]+)$")}function checknumber(a){if(0==a.length)return!0;var b=a.split(",");return a=b.join("."),a.match("^([-]){0,1}([0-9]+)([.]){0,1}([0-9]*)$")}function initEverything(a){var b=window.event?window.event:null==a?null:a;makeIframe(null,utilsIframeName,null,null,"display:none"),initEditableObjList(b)}function initEditableObjList(a){for(var b,c=!1,d=0;b=document.getElementsByTagName("span").item(d);d++)"eattr"==b.className&&"false"==b.getAttribute("readonly")&&(c=!0,0==b.innerHTML.length&&(b.parentNode.onclick=function(a){doEdit(a,getFirstChildTag(this))}),b.addEventListener?b.addEventListener("keypress",preventSubmitOnEnterPress,!1):b.attachEvent&&b.attachEvent("onkeypress",preventSubmitOnEnterPress));if(c&&!document.getElementById(eframeName)){var e=document.getElementsByTagName("body");if(0==e.length)return;var f=e.item(0);makeIframe(f,eframeName,eframeName,"eattrFrame","display:none"),window.frames[eframeName]&&window.frames[eframeName].document&&(window.frames[eframeName].document.open(),window.frames[eframeName].document.close());var g=makeForm(eformName,null,"update.sx",eframeName,"POST",null,null);addInput(g,"objId",""),addInput(g,"attrName",""),addInput(g,"value",""),document.forms[eformName].innerHTML+="",document.close()}}function preventSubmitOnEnterPress(a){var b=window.event?window.event:a,c=window.event?b.srcElement:b.target;if(13==b.keyCode&&1==c.nodeType&&"INPUT"==c.tagName.toUpperCase()){try{c.blur()}catch(a){}return getFalse(b)}}function prepareDoEditOnGridCell(a){var b=window.event?window.event:a,c=window.event?b.srcElement:b.target;if(13!=b.keyCode||"TD"!=c.tagName.toUpperCase())return getFalse(b);for(var d=c.getElementsByTagName("span"),e=null,f=0;f<d.length;f++)if("eattr"==d[f].className&&null!=d[f].onclick&&d[f].onclick.toString().indexOf("doEdit")>0){e=d[f];break}return null==e?getFalse(b):(e.click(),!0)}function doEdit(a,b){isEAttrChanged=!1;var c=b.getAttribute("type");"false"==b.getAttribute("readonly")&&(null!=b&&(b.style.width=""),"string"==c&&setNewStr(b),"date"==c&&setNewDate(b),"boolean"==c&&setNewBoolean(b)),self.setChanged&&self.setChanged()}function setNewDate(a){doBlurForDate&&lastCalGridObject&&getNewDate(lastCalGridObject);var b=getFirstChildTag(a);if(!b||"INPUT"!=b.tagName){var c=a.getAttribute("attrName");if(null!=c&&""!=c){var d="",e=a.getAttribute("objId");e&&(d="_"+e.substring(e.indexOf("@")+1));var f=a.getAttribute("attrTitle");f=null==f?c:f;var g=getForm(a);if(null!=g){"&nbsp;"==a.innerHTML&&(a.innerHTML="");var h=a.offsetWidth>0?a.offsetWidth<80?80:a.offsetWidth:0;if(0==h)if(null!=a.getAttribute("mask")){var i=parseMask(a.getAttribute("mask"));h=8*i.length}else h=80;eattrHtml=a.innerHTML,a.innerHTML="";var j=a.getAttribute("attrType"),k="<input type='hidden' name='data("+c+")' id='data("+c+d+")' />";a.innerHTML+=k;var l="<input type='text' name='date("+c+")'  id='date("+c+d+")' tip='date' attrTitle='"+f+"' maxlength=10 hidElem='data("+c+d+")' onblur='prepareGetNewDate(event)' />";self.addCalendar&&(l+="<span id='buttons_"+c+d+"'><button class='lnk' title='Выбрать' onClick=\"if (self.showCal) {doBlurForDate=false;chooseButtonPressedForDate=true;showCal('"+c+d+"',null,event);}return getFalse(event);\"><img src='admin/images/view_up.gif' onMouseOver='newImg(this,view_down)' onMouseOut='newImg(this,view_up)'/></button></span>"),a.innerHTML+=l;var m=document.createElement("INPUT");m.type="text",m.className="virtual",a.appendChild(m),m.focus();var n=$("date("+c+d+")");n.value=eattrHtml,n.className="editStringAttr",n.style.width=h+"px",null!=a.getAttribute("mask")&&n.setAttribute("mask",a.getAttribute("mask")),null!=j&&n.setAttribute("attrType",j),n.addEventListener?(n.addEventListener("focus",getCurrentFieldValue,!1),n.addEventListener("blur",prepareGetNewDate,!1),n.addEventListener("change",setEAttrChanged,!1)):n.attachEvent&&(n.attachEvent("onfocus",getCurrentFieldValue),n.attachEvent("onchange",setEAttrChanged)),self.addCalendar&&addCalendar("Выберите дату",c+d,g,"Неправильный формат даты  '"+f+"'"),n.focus(),a.removeChild(m)}}}}function setNewStr(a){var b=getFirstChildTag(a);if(!b||"INPUT"!=b.tagName||"TEXT"!=b.type.toUpperCase()){var c=a.offsetWidth>0?a.offsetWidth<70?70:a.offsetWidth:0;if(0==c)if(null!=a.getAttribute("mask")){var d=parseMask(a.getAttribute("mask"));c=8*d.length+"px"}else c="100%";eattrHtml=a.innerHTML,a.innerHTML="";var e=a.getAttribute("attrType"),f=document.createElement("INPUT");if(f.type="text",f.value=eattrHtml,null!=e&&"3"==e){var g=f.value;if(g)for(;g.indexOf(" ")>-1;)g=g.replace(" ","");f.value=g}var h=a.getAttribute("attrLength");null==h||isNaN(Number(h))||0==Number(h)||(f.maxLength=h),f.className="editStringAttr",null!=a.getAttribute("mask")&&f.setAttribute("mask",a.getAttribute("mask")),null!=a.getAttribute("regexp_rule")&&(f.setAttribute("regexp_rule",a.getAttribute("regexp_rule")),null!=a.getAttribute("inline")&&f.setAttribute("inline",a.getAttribute("inline"))),f.style.width=c,null!=e&&f.setAttribute("attrType",e),a.appendChild(f),f.addEventListener?(f.addEventListener("focus",getCurrentFieldValue,!1),f.addEventListener("blur",getNewStr,!1),f.addEventListener("change",setEAttrChanged,!1)):f.attachEvent&&(f.attachEvent("onfocus",getCurrentFieldValue),f.attachEvent("onblur",getNewStr),f.attachEvent("onchange",setEAttrChanged)),f.focus()}}function setNewBoolean(a){var b=getFirstChildTag(a);if(b&&"INPUT"==b.tagName&&"CHECKBOX"==b.type.toUpperCase()){var c=b;c.value=b.checked;var d=c,e=d.parentNode;document.forms[eformName].value.value=d.value,document.forms[eformName].objId.value=e.getAttribute("objId"),document.forms[eformName].attrName.value=e.getAttribute("attrName"),document.forms[eformName].submit()}}function getCurrentFieldValue(a){var b=window.event?window.event.srcElement:a.currentTarget;if(null!=b&&"INPUT"==b.tagName){var c=b.getAttribute("tip");c&&"date"==c&&(doBlurForDate=!0),self.initMask&&initMask(b),chooseButtonPressedForDate||(currentFieldValue=b.value)}}function testIfChanged(a){null!=a&&"INPUT"==a.tagName&&null!=currentFieldValue&&currentFieldValue!=a.value&&(isEAttrChanged=!0)}function setEAttrChanged(a){isEAttrChanged=!0}function prepareGetNewDate(a,b){"undefined"==typeof a.tagName?blurElem=window.event?window.event.srcElement:a.currentTarget:blurElem=a,lastCalGridObject=blurElem,b="undefined"==typeof b?null:b,doBlurForDate&&b?getNewDate(blurElem):eattrDateTimer=b?setTimeout("getNewDate(blurElem)",1e4):setTimeout("prepareGetNewDate(blurElem,true)",300)}function getNewDate(a){var b="INPUT"==a.tagName?a:a.document.getElementsByTagName("INPUT")[1],c=b.getAttribute("hidElem");if(null!=c){var d=b.getAttribute("attrTitle");d=null==d?b.name:d,setDatetoHidden(b,c,'Неправильный формат даты поля " '+d+' "');var e=$(c)}testIfChanged(b);var f=getParentByTagName(b,"span");if(null!=f){try{isEAttrChanged?null!=e?(document.forms[eformName].value.value=""!=e.value?e.value:"",document.forms[eformName].objId.value=f.getAttribute("objId"),document.forms[eformName].attrName.value=f.getAttribute("attrName"),document.forms[eformName].submit(),f.innerHTML=b.value):f.innerHTML=b.value.indexOf("x")!=-1?"&nbsp;":b.value:"INPUT"==b.tagName&&"TEXT"==b.type.toUpperCase()&&null==eattrHtml||(f.innerHTML=eattrHtml),0==f.innerHTML.length&&(f.parentNode.onclick=function(a){doEdit(a,getFirstChildTag(this))})}catch(a){}doBlurForDate=!1,null!=eattrDateTimer&&clearTimeout(eattrDateTimer)}}function getNewStr(a){var b=window.event?window.event.srcElement:a.currentTarget,c=0;if(c=b&&null!=b.getAttribute("regexp_rule")?validateFieldByRegExp(b):validateField(b,!0),0==c||!c)return getFalse(a);testIfChanged(b);var d=b.parentNode;if(isEAttrChanged){document.forms[eformName].value.value=b.value,document.forms[eformName].objId.value=d.getAttribute("objId"),document.forms[eformName].attrName.value=d.getAttribute("attrName");var e=!0;if(null!=b.getAttribute("attrType")){var f=b.getAttribute("attrType");"2"==f?checkinteger(b.value)||(alert("Это поле может содержать только целые числа"),e=!1):"3"==f&&(checknumber(b.value)||(alert("Это поле может содержать только вещественные значения"),e=!1))}document.forms[eformName].submit(),showFullValue(b),"INPUT"==b.tagName&&"TEXT"==b.type.toUpperCase()&&null==eattrHtml||(d.innerHTML=b.value)}else"INPUT"==b.tagName&&"TEXT"==b.type.toUpperCase()&&null==eattrHtml||(d.innerHTML=eattrHtml);0==d.innerHTML.length&&(d.parentNode.onclick=function(a){doEdit(a,getFirstChildTag(this))})}function isVisible(a){do{try{if(a.nodeType>1)break}catch(a){}var b=a.currentStyle?a.currentStyle.display:isN6?a.ownerDocument.defaultView.getComputedStyle(a,null).getPropertyValue("display"):"",c=a.currentStyle?a.currentStyle.visibility:isN6?a.ownerDocument.defaultView.getComputedStyle(a,null).getPropertyValue("visibility"):"";if("none"==b||"invisible"==c)return!1}while(a=a.parentElement?a.parentElement:a.parentNode);return!0}function showMessage(a,b,c){var d=a?a:window,e=d.document.body;window.scroll(0,0);var f='<table cellpadding="10" class="messArea" cellspacing="0">'+(c&&""!=c?'<tr><td align="left" valign="top" class="messCaption">'+c+"</td></tr>":"")+'<tr><td align="center" valign="middle">'+b+"</td></tr></table>",g=$("popupMessageDiv");if(!g){var h=d.document.createElement("DIV");h.setAttribute("id","popupMessageDiv"),e.appendChild(h),g=h}g.innerHTML=f,g.className="showMess_active";var i=Math.round(4*(e.clientWidth-g.offsetWidth)/9),j=(isIE?e.scrollLeft:window.scrollX)+i,k=300,l=e.clientHeight;(l<=1&&d.innerHeight||l>1&&!isIE||l<screen.availHeight)&&(k=Math.round(4*((d.innerHeight?d.innerHeight:l)-g.offsetHeight)/9));var m=(isIE?e.scrollTop:window.scrollY)+k;isIE?(g.style.pixelLeft=j,g.style.pixelTop=m):(g.style.left=j+"px",g.style.top=m+"px"),g.oncontextmenu=new Function("return false"),d.addShadow&&d.addShadow(),d.showShadow&&d.showShadow()}function hideMessage(a,b){var c=a?a:window;b||(b="popupMessageDiv");var d="string"==typeof b?c.document.getElementById(b):b;d&&(d.innerHTML="",d.className="editForm_passive",d.oncontextmenu="",c.hideShadow&&c.hideShadow())}function popupMsgOn(a,b,c){showMessage(a,b,c)}function popupMsgOff(a){hideMessage(a)}function envokeAllEvent(a){a.document.removeEventListener?(a.removeEventListener("scroll",stopEvents,!1),a.document.removeEventListener("mouseup",stopEvents,!1),a.document.removeEventListener("keydown",stopEvents,!1),a.document.removeEventListener("keyup",stopEvents,!1)):a.document.detachEvent&&(a.detachEvent("onscroll",stopEvents),a.document.detachEvent("onmouseup",stopEvents),a.document.detachEvent("onmousedown",stopEvents),a.document.detachEvent("onkeydown",stopEvents),a.document.detachEvent("onkeyup",stopEvents))}function stopAllEvent(a){a.document.oncontextmenu=new Function("return false"),a.document.addEventListener?(a.addEventListener("scroll",stopEvents,!1),a.document.addEventListener("mouseup",stopEvents,!1),a.document.addEventListener("keydown",stopEvents,!1),a.document.addEventListener("keyup",stopEvents,!1)):a.document.attachEvent&&(a.attachEvent("onscroll",stopEvents),a.document.attachEvent("onmouseup",stopEvents),a.document.attachEvent("onmousedown",stopEvents),a.document.attachEvent("onkeydown",stopEvents),a.document.attachEvent("onkeyup",stopEvents))}function stopEvents(a){window.scrollTo(0,0);var a=window.event?window.event:a;return a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),!1}function makeGridRow(a,b){this.cName=a,this.code=b,this.toString=function(){return"names:\n"+this.cName.toString()+"\n\ncodes:\n"+this.code.toString()}}function getSelectMode(){return selectMode}function setSelectMode(a){selectMode=a}function getSelectedObjectType(){var a=OBJECT_MODE;if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var b;for(i=0;i<self.parent.frames.length;i++)if(b=self.parent.frames[i],b.getSelectMode&&b.getSelectMode()!=a)return b.getSelectMode()}else if(getSelectMode&&getSelectMode()!=a)return getSelectMode();return a}function clearSelected(a,b,c){if(null==b&&(b=self),b.selectedIdArray=null,b.selectedTitleArray=null,b.exceptionIdArray=null,c||null!=a){if(c||(c=a.name),c&&c.length>0){var d=b.document.getElementsByName(c);if(0!=d.length)if("checkbox"==d[0].type||"radio"==d[0].type)for(var e=0;e<d.length;e++)d[e].checked=!1;else alert("Ошибка в шаблоне или в object.js !")}b.selectedObj&&(b.selectedObj.className="black",b.selectedObj=null),b.setSelectMode(OBJECT_MODE)}}function prepareSelect(a,b,c){if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var d;for(i=0;i<self.parent.frames.length;i++)d=self.parent.frames[i],d.getSelectMode&&d.getSelectMode()!=b&&clearSelected(a,d,c)}else getSelectMode&&getSelectMode()!=b&&clearSelected(a,self,c)}function getSelObjects(a){if(ret=new Array,!a&&self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var b;for(ret[0]=new Array,ret[1]=new Array,i=0;i<self.parent.frames.length;i++)b=self.parent.frames[i],b.selectedIdArray&&b.selectedTitleArray&&(ret[0]=ret[0].concat(b.selectedIdArray),ret[1]=ret[1].concat(b.selectedTitleArray)),b.gridDataArray&&b.gridDataArray.length>0&&(ret[2]=new Array,ret[2]=ret[2].concat(b.gridDataArray))}else ret[0]=selectedIdArray,ret[1]=selectedTitleArray,gridDataArray&&gridDataArray.length>0&&(ret[2]=new Array,ret[2]=gridDataArray);return ret}function getSelectAllSelected(){if(result=null,self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var a;for(i=0;i<self.parent.frames.length;i++)a=self.parent.frames[i],"true"==a.selectAllSelected&&(result=a.selectAllSelected)}else result=selectAllSelected;return result}function getExceptObjects(){var a=new Array;if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var b;for(i=0;i<self.parent.frames.length;i++)b=self.parent.frames[i],b.exceptionIdArray&&(a=a.concat(b.exceptionIdArray))}else a=exceptionIdArray;return a}function sendExceptionObjIds(a){null!=a&&"FORM"==a.tagName.toUpperCase()&&(s=exceptionObjIds(),""!=s&&makeInput(a,"hidden","exeptionObjIds",s))}function exceptionObjIds(){s="";var a=getExceptObjects();if(a)for(var b=0;b<a.length;b++)s+=a[b],b<a.length-1&&(s+=",");return s}function getParamsHashCode(){if(result=null,self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var a;for(i=0;i<self.parent.frames.length&&(a=self.parent.frames[i],result=a.paramsHashCode,null==result||"undefined"==typeof result);i++);}else result=paramsHashCode;return result}function setParamsHashCode(a){if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var b;for(i=0;i<self.parent.frames.length;i++)b=self.parent.frames[i],b.paramsHashCode=a}else paramsHashCode=a}function getSelectedIdArray(){if(!(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0))return selectedIdArray;for(var a,b=0;b<self.parent.frames.length;b++)return a=self.parent.frames[b],a.selectedIdArray}function setSelectedIdArray(a){if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.list){var b=self.parent.frames.list;b&&(b.selectedIdArray=a),b=self.parent.frames.nav,b&&(b.selectedIdArray=null)}else selectedIdArray=a}function setSelectedTitleArray(a){if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.list){var b=self.parent.frames.list;b&&(b.selectedTitleArray=a),b=self.parent.frames.nav,b&&(b.selectedTitleArray=null)}else selectedTitleArray=a}function getSelectedTitleArray(){if(!(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0))return selectedTitleArray;for(var a,b=0;b<self.parent.frames.length;b++)return a=self.parent.frames[b],a.selectedTitleArray}function isSelected(){var a=getSelObjects(),b=!1;try{b=a&&a.length>0&&null!=a[0]&&a[0].length>0}catch(a){}return"true"==getSelectAllSelected()&&(b=!0),b}function prepareListAttrValues(a){var b=self.document.forms.getCustomObjList,c=getSelObjects();if((null==c[0]||""==c[0])&&"true"!=getSelectAllSelected())return alert("Ни один объект не выбран."),!1;for(var d="",e=0;e<c[0].length;e++)d+=c[0][e],e<c[0].length-1&&(d+=",");b.elements.customObjList.value=d,null!=a&&a&&(b.elements.operation.value="getViewLinkMN"),b.sessionParams.value=getSelectAllSelected(),sendExceptionObjIds(b),b.submit()}function recieveListAttrValues(){var a=null;if(a=isIE?self.document.frames.getObjListAttrVals:self.frames.getObjListAttrVals,a&&null!=a.ar){var b=a.ar;gridDataArray=new Array;for(var c=0;c<b.length;c++){for(var d=new Array,e=new Array,f=0;f<b[c].length;f++){var g=b[c][f];d.push(g[1]),e.push(g[0])}if(d.length>0&&e.length>0){var h=new makeGridRow(e,d);gridDataArray.push(h)}}}selectObj(window,!0,null,"false")}function selectObj(a,b,c,d,e,f){if(null==b&&(b=!0),"true"!=d){if(self.parent&&self.parent!=self&&self.parent.frames&&self.parent.frames.length>0){var g=!1;if(e){ret=getSelObjects(!0);var h=self.parent.$(a.name);try{g=!(!h||null==a.setLinkObj)&&(null!=c?a.setLinkObj(ret,a,c,f):a.setLinkObj(ret,a,null,f)),b&&g&&h&&a.hideShadowForAll&&a.hideShadowForAll()}catch(a){}}else{ret=getSelObjects();var i=self.parent.opener;g=!(!i||i.closed||null==i.setLinkObj)&&(null!=c?i.setLinkObj(ret,self.parent,c):i.setLinkObj(ret,self.parent)),b&&g&&(i&&!i.closed&&i.hideShadowForAll&&i.hideShadowForAll(),self.parent.close())}return g}ret=getSelObjects();var i=window.opener;try{var g=!(!i||i.closed||null==i.setLinkObj)&&(null!=c?i.setLinkObj(ret,a,c):i.setLinkObj(ret,a));b&&g&&(i&&!i.closed&&i.hideShadowForAll&&i.hideShadowForAll(),window.close())}catch(a){}return g}selectAllSelectObj("chooseFrame","ChooseForm",b,c)}function selectAllSelectObj(a,b,c,d){var f=(getListFrame(a),self.document.forms[b]);sendExceptionObjIds(f),f.isClose.value=c,f.canDouble.value=d,f.submit()}function gridSelect(a,b,c,d,e,f){a||(a="grid_"),b||(b="title_"),f||(f="");var g=document.getElementById(a+c+d);if(g){var h=document.getElementById(b+c),i=h&&""!=h.value?document.getElementById(a+c+h.value):null,j=!0;i&&(i.id==g.id&&(j=!1),i.className=f,h.value="",window.showDelButInRow&&window.showDelButInRow(i,c,!1)),j&&(e&&(g.className=e),h.value=d,window.showDelButInRow&&window.showDelButInRow(g,c,!0))}}function fldSelFolder(a,b,c){null!=self.parent.nav.fldid&&(self.parent.nav.fldid.value=a[b])}function selFolder(a,b,c){getSelectMode()!=FOLDER_MODE&&setSelectMode(FOLDER_MODE),prepareSelect(a,FOLDER_MODE),setSelectMode(FOLDER_MODE),selId(a,b,c)}function selObject(a,b,c){getSelectMode()!=OBJECT_MODE&&setSelectMode(OBJECT_MODE),0==doWithAll?(prepareSelect(a,OBJECT_MODE),setSelectMode(OBJECT_MODE),selId(a,b,c),null!=self.parent&&null!=self.parent.toolbar&&null!=self.parent.toolbar.selobjid&&(self.parent.toolbar.selobjid.value=a[b])):1==doWithAll&&(prepareSelect(a,OBJECT_MODE),
setSelectMode(OBJECT_MODE),selAllId(a,b,c),doWithAll=2)}function selId(a,b,c){b||(b="value"),c||(c="title"),exceptionIdArray=new Array,selectedIdArray=new Array,selectedTitleArray=new Array,self.getAllreadySelected&&getAllreadySelected(),"true"==selectAllSelected&&(selectedIdArray.length=0,selectedTitleArray.length=0);var d=document.getElementsByName(a.name);if(0!=d.length){if("checkbox"==d[0].type)for(var e=0;e<d.length;e++)d[e].checked?"true"==selectAllSelected?contains(exceptionIdArray,d[e][b])&&exceptionIdArray.pop(d[e][b]):contains(selectedIdArray,d[e][b])||(selectedIdArray.push(d[e][b]),selectedTitleArray.push(d[e][c])):"true"==selectAllSelected?contains(exceptionIdArray,d[e][b])||exceptionIdArray.push(d[e][b]):contains(selectedIdArray,d[e][b])&&(selectedIdArray.pop(d[e][b]),selectedTitleArray.pop(d[e][c]));else"radio"==d[0].type?contains(selectedIdArray,a[b])||(selectedIdArray.push(a[b]),selectedTitleArray.push(a[c])):contains(selectedIdArray,a[b])||(selectedIdArray.push(a[b]),selectedTitleArray.push(a[c]));self.showChoosenObjNumber&&"false"==selectAllSelected&&showChoosenObjNumber(),self.setButtonState&&setButtonState()}}function selAllId(a,b,c){b||(b="value"),c||(c="title"),selectedIdArray=new Array,selectedTitleArray=new Array,self.getAllreadySelected&&getAllreadySelected(),"true"==selectAllSelected&&(selectedIdArray.length=0,selectedTitleArray.length=0);var d=document.getElementsByName(a.name);if(0!=d.length&&"checkbox"==d[0].type){for(var e=0;e<d.length;e++)doSetAll?(d[e].checked="true","true"==selectAllSelected?contains(exceptionIdArray,d[e][b])&&exceptionIdArray.pop(d[e][b]):contains(selectedIdArray,d[e][b])||(selectedIdArray.push(d[e][b]),selectedTitleArray.push(d[e][c]))):("true"==selectAllSelected?contains(exceptionIdArray,d[e][b])||exceptionIdArray.push(d[e][b]):contains(selectedIdArray,d[e][b])&&(selectedIdArray.pop(d[e][b]),selectedTitleArray.pop(d[e][c])),d[e].removeAttribute("checked"));self.setButtonState&&setButtonState()}}function delLinksOnDelete(a,b){var c=getWinAttr(a);if(c){var d=document.getElementById("title_"+c),e=document.getElementById("grid_"+c);null!=d&&("SELECT"==d.tagName||"INPUT"==d.tagName&&e?DelFromList(c,b):delLinkObj(c))}}function fireOnChange(a){if(a.fireEvent)a.fireEvent("onchange");else if(a.dispatchEvent){var b=document.createEvent("HTMLEvents");b.initEvent("change",!0,!0),a.dispatchEvent(b)}else a.onchange&&a.onchange()}function setLinkObj(a,b,c,d){if(updateToOpenerOpener){var e=b.opener;e&&!e.closed&&(b=e)}var f=getWinAttr(b,d);if(!f)return!1;if(null!=a){if(Sel=document.getElementById("title_"+f),!Sel)return!1;Hid=document.getElementById("id_"+f);var g=Sel.getAttribute("megaGridAttr");null!=g&&(f=g),null==c&&(canDouble2=document.getElementById("dup_"+f),null!=canDouble2&&(c="true"==canDouble2.value));var h=document.getElementById("grid_"+f),i=document.getElementById("isLinkNto1_"+f);i||(i=document.getElementById("isLink1to1_"+f));var j,k,l;if("SELECT"==Sel.tagName){var m,n,o=a[0],p=a[1],q=new HashMap;if(!c)for(var r=0;r<Sel.length;r++)q.put(Sel.options[r].value,r);for(k=0,l=o.length;k<l;k++)n=(new Date).getTime(),c||!q.containsKey(o[k])?(j=document.createElement("OPTION"),j.value=o[k],j.text=p[k],m=isIE?Sel.add(j):Sel.add(j,null),Sel.selectedIndex=Sel.length-1,removeFromHiddenDel(f,o[k])):Sel.options[q.get(o[k])].text=p[k];q.clear(),ToHidden(Sel,Hid),Sel&&fireOnChange(Sel),Hid&&fireOnChange(Hid)}else if("INPUT"==Sel.tagName&&h){var s,t,u,v,w=h.parentNode;if("table"==w.nodeName.toLowerCase()){s=w,t=s.getElementsByTagName("thead").item(0);var x=t.getElementsByTagName("tr");v=x[x.length-1]}else s=w.parentNode,t="thead"==w.nodeName.toLowerCase()?w:s.getElementsByTagName("thead").item(0),v=h;u=getNextSiblingTag(t),w=null;var y,z,A,B,C=u.getElementsByTagName("TR").length;o=a[0],p=a[1];var D=a[2];if(i){var E=u.getElementsByTagName("TR")[0];if(E){var F=E.getAttribute("objId");o!=F&&(document.getElementById("title_"+f).value=F,DelFromList(f))}}var J,K,L,M,G=isElemInArray(gridTabIndexArr,"name",f,2),H=null!=G?G.lastIndex:-1,I=null!=G?G.rows:0;for(k=0,l=o.length;k<l;k++){if(B="grid_"+f+o[k],!c){if(E=document.getElementById(B),!E){var N=getObjectByAttr(u,"TR","toId",o[k],1);null!=N&&(E=N[0])}if(null!=E){if(null==D||0==D.length)continue;J=D[k].cName,K=D[k].code;for(var O=E.getElementsByTagName("td"),P=0;P<O.length;P++){var Q=O[P].getAttribute("cName");null!=Q&&""!=Q&&(L=contains(J,Q,!0),L>=0&&L<K.length&&(O[P].innerHTML=K[L]))}continue}}var R=!1,S=document.getElementById("isMadTable_"+f);null!=S&&"true"==S.value&&(R=!0),y=document.createElement("tr"),I++,R&&"undefined"!=typeof o[k]&&y.setAttribute("toId",o[k]),y.setAttribute("id",B),y.setAttribute("objId",o[k]),y.className="gridRow";var W,X,T=v.childNodes,U=v.getElementsByTagName("td").length+v.getElementsByTagName("th").length,V=!0;if(null==D||"undefined"==typeof D[k]||null==T){var Y=document.createElement("td"),Z=document.createTextNode(" ");for(Y.appendChild(Z),y.appendChild(Y),Y.innerHTML="&nbsp;",z=document.createElement("td"),z.setAttribute("tabIndex",H<0?-1:H++),A=document.createTextNode(p[k]),z.appendChild(A),y.appendChild(z),H>=0&&(z.onkeyup=function(a){return prepareDoEditOnGridCell(a)}),M=0;M<U-3;M++)W=document.createElement("td"),W.setAttribute("tabIndex",H<0?-1:H++),X=document.createTextNode(" "),W.appendChild(X),y.appendChild(W),W.innerHTML="&nbsp;",H>=0&&(W.onkeyup=function(a){return prepareDoEditOnGridCell(a)}),W=null,X=null}else{J=D[k].cName,K=D[k].code;var $=!1;for(M=0;M<T.length;M++){var _=T[M];if(1==_.nodeType&&"SCRIPT"!=_.tagName.toUpperCase())if("Lborder"!=_.className)if("Rborder"!=_.className){if(W=document.createElement("td"),null==_.getAttribute("cName"))L=-1;else{var aa=_.getAttribute("cName");L=contains(J,aa,!0)}L==-1?(X=document.createTextNode(" "),W.appendChild(X),W.innerHTML="&nbsp;"):("undefined"!=typeof J[L]&&W.setAttribute("cName",J[L]),W.innerHTML="undefined"!=typeof K[L]?K[L]:"&nbsp;",W.setAttribute("tabIndex",H<0?-1:H++)),y.appendChild(W),H>=0&&(W.onkeyup=function(a){return prepareDoEditOnGridCell(a)}),W=null,X=null}else $=!0;else Y=document.createElement("td"),Z=document.createTextNode(" "),Y.appendChild(Z),y.appendChild(Y),Y.innerHTML="&nbsp;"}V=$}V&&(W=document.createElement("td"),W.className="Rborder",X=document.createTextNode(" "),W.appendChild(X),y.appendChild(W)),u.appendChild(y),u.lastChild.onclick=new Function("gridSelect('grid_','title_','"+f+"','"+o[k].replace(/'/g,"\\'")+"','silver','gridRow')"),i?Hid.value=o[k]:Hid.value+=","+o[k]}null!=G&&(G.rows=I,G.lastIndex=H),Sel&&fireOnChange(Sel),Hid&&fireOnChange(Hid),1==C&&u.getElementsByTagName("TR").length>1&&self.removeNoDataGridRow&&removeNoDataGridRow(s),!isIE&&initScrollContentForMozz&&initScrollContentForMozz("grid_container_thead_"+f,"grid_container_tbody_"+f,"grid_container_"+f,!0)}else Hid.value=a[0],Sel.value=a[1],Sel&&fireOnChange(Sel),Hid&&fireOnChange(Hid)}return!0}function getSm(a,b,c){var d=null;return d=c?a&&b?"m":a?"mf":"mo":a&&b?"s":a?"sf":"so"}function escapeEx(a){var b="";for(i=0;i<a.length;i++){var c=a.charCodeAt(i);c>=1040&&c<=1103?c-=848:1105==c?c=184:1025==c&&(c=168),b+=(c<65||c>90)&&(c<97||c>122)&&c<256?c<16?"%0"+c.toString(16):"%"+c.toString(16):String.fromCharCode(c)}return b}function getNewObjForm(a,b,c,d,e,f,g,h,i,j,k,l,m){var n="",o=null;if("undefined"!=typeof DLA&&DLA.ajaxLinkAttrs[a]&&DLA.ajaxLinkAttrs[a].formAttrs)o=DLA.ajaxLinkAttrs[a].formAttrs;else if("undefined"!=typeof Control){var p=Control.SimpleList.findById("id_"+a);p&&(o=p.formAttrs)}if(o)for(var q in o)n=n+"&queryParam(curObject."+q+")="+o[q];getNewObj(a,b,c,d,e,f,g,h,i,j,k,l,m,n)}function getNewObj(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=!0;getNewObjUnivers(a,b,c,d,e,f,g,h,i,j,k,l,m,o,n)}function getNewObjWithoutAttr(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=!1;getNewObjUnivers(a,b,c,d,e,f,g,h,i,j,k,l,m,o,n)}function getNewObjUnivers(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=getSm(d,e,f),q="";n&&(q="&q(attr)="+a),h=h?"&q(obj)="+escapeEx(h)+q:i&&j?"&q(cls)="+i+"&q(ds)="+j+q:"";var r="";c&&""!=c&&(r="&selCls="+c),b&&"null"!=b||(b=""),mb="",k&&f&&(mb="&mb=1"),gridt="",null!=l&&""!=l&&l&&(gridt="&gridt=1"),g&&g.indexOf(".htm")==g.length-4&&(g=g.substring(0,g.length-4)),o||(o="");var s=doOpenWindow(baseUrl+g+".htm?id="+b+r+"&sm="+p+gridt+mb+h+o),t=(null==m?"":m)+a;addWin(s,t,c)}function getObjSearch4Param(a,b,c,d,e,f,g,h,i){var j=getSm(d,e,g);h?(h="&paramQuery="+h,i&&(h=h+"&paramObject="+i)):h="";var k="";c&&""!=c&&(k="&selCls="+c);var l=doOpenWindow(baseUrl+f+".htm?id="+b+k+"&sm="+j+h);addWin(l,a,c)}function createObj(a,b,c,d,e,f,g,h,i,j,k,l){var m="";f&&"null"!=f&&(m="&ds="+f);var n="";0==l&&(n="&detail=false");var o="";h&&(o="&link="+h),i||(i="");for(var p="&",q=0;q<32;q++)p+=parseInt(16*Math.random()).toString(16);var r=e+".htm?id="+b+"&cls="+c+"&ra="+d+m+o+i+p+n,s=url(r,j),t=(null==k?"":k)+a,u=addWin(s,t,c);return g&&addUpdateFrameFunction(s,g),u}function viewObj(a,b,c,d,e,f,g){var h=null==f?a:f,i=document.getElementById(h);if(!i)return!1;var j=null==g?i.value:g;if(null!=g&&(i.value=g),0==j.length)return!1;j=j.replace(/\s/g,"%20"),null==c&&(c="");var k=b+".htm?id="+j+c;viewWindow=url(k,e);var l=null==f?a.indexOf("_"):f.indexOf("_"),m=null==f?a.substring(l+1,a.length):f.substring(l+1,f.length),n=addWin(viewWindow,m);return d&&addUpdateFrameFunction(viewWindow,d),n}function cropImg(a,b,c,d){viewWindow=window.open(b+"util/image/CropImageUtil.sx?cmd=showCroper&objId="+c+"&attrName="+a+"&designCode="+d,"_blank","height=500,width=800,status=yes,toolbar=no,scrollbars=yes,menubar=no,location=no,resizable=no,channelmode=no"),addWin(viewWindow,a)}function delLinkObj(a,b){var c=document.getElementById("id_"+a),d=!!c.value;c.value="",b||(b="");var e=document.getElementById("title_"+a);e.value=b,setChanged(),d&&(fireOnChange(c),fireOnChange(e))}function move(a,b){var c=document.getElementById("title_"+a),d=document.getElementById("id_"+a),e=document.getElementById("grid_"+a+c.value);if(e)if(b){var f=previousSibling(e);f&&f.parentNode.insertBefore(e,f)}else{var g=nextSibling(e);g&&g.parentNode.insertBefore(g,e)}else Indx=c.selectedIndex,b?Indx>0&&(tmpv=c[Indx].value,tmpt=c[Indx].text,tmps=c[Indx].style.color,c[Indx].value=c[Indx-1].value,c[Indx].text=c[Indx-1].text,c[Indx].style.color=c[Indx-1].style.color,c[Indx-1].value=tmpv,c[Indx-1].text=tmpt,c[Indx-1].style.color=tmps,c.selectedIndex=Indx-1):Indx<c.length-1&&Indx>=0&&(tmpv=c[Indx].value,tmpt=c[Indx].text,tmps=c[Indx].style.color,c[Indx].value=c[Indx+1].value,c[Indx].text=c[Indx+1].text,c[Indx].style.color=c[Indx+1].style.color,c[Indx+1].value=tmpv,c[Indx+1].text=tmpt,c[Indx+1].style.color=tmps,c.selectedIndex=Indx+1);ToHidden(c,d,e),self.setChanged&&setChanged()}function previousSibling(a){var b=a.previousSibling;return null!=b&&"#"==b.nodeName[0]&&(b=previousSibling(b)),b}function nextSibling(a){var b=a.nextSibling;return null!=b&&"#"==b.nodeName[0]&&(b=nextSibling(b)),b}function addToHiddenDel(a,b){if(null!=b&&""!=b){var c=document.getElementById("del_id_"+a);if(null!=c){var d=","+b;c.value+=d}}}function manageCheckBoxAttr(a){if(a&&("INPUT"==a.tagName||"CHECKBOX"==a.type.toUpperCase())){var b=a.checked,c=a.getAttribute("objId");if(c){var d=a.getAttribute("attrName");d&&(b?removeFromHiddenDel(d,c):addToHiddenDel(d,c))}}}function removeFromHiddenDel(a,b){if(b){var c=document.getElementById("del_id_"+a);if(null!=c&&""!=c.value){var d=new Array;d=c.value.split(","),contains(d,b)&&d.pop(b),c.value=d.join(",")}}}function DelFromList(a,b){var c=document.getElementById("title_"+a),d=document.getElementById("id_"+a),e=document.getElementById("del_id_"+a),f=new RegExp("[, ]","g"),g=c.value.replace(f,"");if(""==g){if(null==b||""==b)return;var h=b}else var h=c.value;var j=document.getElementById("grid_"+a+h);if("INPUT"==c.tagName&&j){var k=j.parentNode;k.removeChild(j);var g=d.value,l=","+h;d.value=d.value.substring(0,d.value.indexOf(l))+d.value.substring(d.value.indexOf(l)+l.length,d.value.length),e&&(e.value+=l),c.value=""}else{for(i=0;i<c.length;)c.options[i].selected?(e&&(e.value+=","+c.options[i].value),c.remove(i)):++i;ToHidden(c,d)}self.setChanged&&setChanged(),d&&d.onchange&&d.onchange(),c&&c.onchange&&c.onchange()}function DelAllFromList(a){var b=document.getElementById("title_"+a),c=document.getElementById("id_"+a);for(i=0;i<b.length;)b.remove(i);ToHidden(b,c),self.setChanged&&setChanged()}function resizeSelect(a){if(null!=a&&""!=a){var b=document.getElementById(a);if(null!=b&&"SELECT"==b.tagName){for(var c=1,d=0;d<b.length;d++){var e=b.options[d].text.length;e>c&&(c=e)}b.style.width=c+12+"ex"}}}function postParamsPares(a,b){this.name=a,this.value=b}function sendPostInNewWindow(a,b,c,d,e){var f=null==c||""==trim(c)?"myPostWin":c,g=null==d||""==trim(d)?getPopupWinWidth():d,h=null==e||""==trim(e)?getPopupWinHeight():e,i=window.open("",f,"height="+h+",width="+g+",status=yes,toolbar=no,scrollbars=yes,menubar=no,location=no,resizable=yes,channelmode=no");sendPostInWindow(a,b,i)}function sendPostInWindow(a,b,c){if(null!=a&&null!=b&&null!=c&&"undefined"!=typeof b.length&&0!=b.length){var d=null,e=null;isIE?(d=document.getElementsByTagName("body").item(0),e=document.createElement("FORM"),e.target=c.name):(c.document.write('<html><head><base href="'+baseUrl+'"></head><body></body></html>'),d=c.document.getElementsByTagName("body").item(0),e=c.document.createElement("FORM"),e.target="_self"),e.action=a,e.method="POST",e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.className="eattrFrame",d.appendChild(e);for(var f=0;f<b.length;f++)makeInput(e,"hidden",b[f].name,b[f].value);e.submit()}}function addShadow(a,b){null==a&&(a=self);var c=b?b:a.document.getElementsByTagName("body")[0],d=a.document.getElementById("overlay");if(null==a.document.getElementById("overlay")){var e=a.document.createElement("iframe");e.setAttribute("frameborder","no"),e.setAttribute("scrolling","no"),e.setAttribute("id","overlay"),e.style.overflow="hidden",browserInfo&&browserInfo.isIE6,c.appendChild(e),d=e}return d}function manageShadowForFrameset(a,b){for(var c,d=0;d<a.frames.length;d++)c=a.frames[d],"undefined"==typeof c.document.getElementsByTagName("frameset")[0]?b?(addShadow(c),showShadow(c)):hideShadow(c):manageShadowForFrameset(c,b)}function showShadowForAll(){if(useModalWindows){var a=top;a.frames&&a.frames.length>0?"undefined"!=typeof a.document.getElementsByTagName("body")[0]?(addShadow(a),showShadow(a)):manageShadowForFrameset(a,!0):(addShadow(),showShadow())}}function hideShadowForAll(){if(useModalWindows){var a=top;if(a.frames&&a.frames.length>0)if("undefined"!=typeof a.document.getElementsByTagName("body")[0])hideShadow(a);else{manageShadowForFrameset(a,!1)}else hideShadow()}}function showShadow(a){null==a&&(a=self);var b=a.document.getElementById("overlay");if(null!=b||(b=addShadow(a),null!=b)){var c=a.document.body,d=c.clientWidth,e=c.clientHeight,f=c.scrollWidth,g=c.scrollHeight;b.style.width=f>d?f:d,b.style.height=g>e?g:e,b.style.display="block",b.addEventListener?(b.addEventListener("focus",setFocusToModal,!1),b.addEventListener("scroll",setFocusToModal,!1)):b.attachEvent&&(b.attachEvent("onfocus",setFocusToModal),b.attachEvent("onscroll",setFocusToModal))}}function hideShadow(a){null==a&&(a=self);var b=a.document.getElementById("overlay");if(null!=b&&(b.style.display="none",currentModalWin=null,b.removeEventListener?(b.removeEventListener("focus",setFocusToModal,!1),b.removeEventListener("scroll",setFocusToModal,!1)):b.detachEvent&&(b.detachEvent("onfocus",setFocusToModal),b.detachEvent("onscroll",setFocusToModal)),!browserInfo||!browserInfo.isIE6)){var c=b.parentNode;c&&c.removeChild(b)}}function setFocusToModal(){null!=currentModalWin&&currentModalWin.focus()}function doOpenWindow(a){var b=null;if(useModalWindows)null!=currentModalWin?(b=currentModalWin,b.location.replace(a)):(b=window.open(a,"_blank","height="+getPopupWinHeight()+",width="+getPopupWinWidth()+",status=yes,toolbar=no,scrollbars=yes,menubar=no,location=no,resizable=yes,channelmode=no"),currentModalWin=b),showShadowForAll(),b.focus(),handleModalLoad();else{var c="_blank";if(a.indexOf("edit")!=-1){var d=new Array("/","@",".",",","$","&","!","?",":","*","#","+",";","_","=","-","%40","%"),e=a.match("id=([^&]*)");if(null!=e&&e.length>=2){var f=baseUrl;c=f+e[1];for(var g=0;g<d.length;g++)c=replaceSubstring(c,d[g])}}try{b=window.open(a,c,"height="+getPopupWinHeight()+",width="+getPopupWinWidth()+",status=yes,toolbar=no,scrollbars=yes,menubar=no,location=no,resizable=yes,channelmode=no"),b.focus()}catch(a){window.debug&&window.debug(a)}}return b}function handleModalLoad(){var a=currentModalWin;if(a.closed)return void hideShadowForAll();var b=null;try{b=a.document.body}catch(a){}null!=b&&""!=b.innerHTML||setTimeout("handleModalLoad()",1e3)}function doThisBeforeClose(){var a=function(a){var b=window.event?window.event:a,c=null!=document.getElementById("modified")?document.getElementById("modified").form:null;saveQuery(c,b)};isIE?document.body.onbeforeunload=a:window.onbeforeunload=a;var b=new Function("var wo=window.opener; if(closeWinFlag==true && wo && !wo.closed && wo.hideShadowForAll) wo.hideShadowForAll();");onPerformUnload(window,b)}function prepareObjs(a){var b=null;if(b=getSelObjects()[0],b&&b.length>0)b=b.join(",");else if(b=a,b.indexOf("SXUser")==-1)return null;return $("__createPersCards_ids").value=b,$("createPersCards").submit(),null}function printF(a){a.onblur=function(){a.focus()},a.focus(),a.print(),a.onblur=function(){}}function manageSpoiler(a,b,c){if(a){var d=getNextSiblingTag(a);if(d){"undefined"!=typeof b&&null!=b&&""!=b||(b="images/ad.gif"),"undefined"!=typeof c&&null!=c&&""!=c||(c="images/au.gif");var e="none"==d.style.display;e?(a.style.background="transparent url("+c+") no-repeat left center",d.style.display="block"):(a.style.background="transparent url("+b+") no-repeat left center",d.style.display="none")}}}function getCookie(a){var b=document.cookie,c=b.split(";");b=c.join("");for(var d=b.split(" "),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]==a)return f[1]}return null}function clearCookie(a,b){null!=b&&""!=b||(b=getCookie(a)),b||(b="");var c=new Date;c.setTime(c.getTime()-864e5),document.cookie=a+"="+b+"; expires="+c.toGMTString()+"; path=/"}function setCookie(a,b,c){isNaN(parseInt(c))&&(c=1);var d=new Date;d.setTime(d.getTime()+60*(c+3)*60*1e3),document.cookie=a+"="+b+"; expires="+d.toGMTString()+"; path=/"}function copyFormToForm(a,b){for(var c=a,d=b,e=0;e<c.elements.length;e++){var f=c.elements[e];if(null!=f.value&&""!=f.value&&null!=d.elements[f.name]&&"undefined"!=typeof d.elements[f.name]&&d.elements[f.name].type==f.type){var g=d.elements[f.name];switch(f.type){case"text":case"textarea":g.value=f.value;break;case"CHECKBOX":case"RADIO":f.checked&&(g.checked=!0);break;case"select-one":g.selectedIndex=f.selectedIndex;break;case"select-multiple":for(var h=0;h<f.options.length;h++)f.options[h].selected&&null!=g.options[h]&&"undefined"!=typeof g.options[h]&&(g.options[h].selected=!0)}}}}function selectObjColor(a){var b=document.getElementById("id_"+a),c=document.getElementById("color_id_"+a),d=showModalDialog(baseUrl+"scripts/selcolor.html",window,"dialogWidth:370px;dialogHeight:240px;help:no;scroll:no;status:no");b&&(b.value=d),c&&(c.style.backgroundColor=d)}function manageLogin(a){var b=window.location,c=void 0!=typeof window.baseUrl?baseUrl.substring(0,baseUrl.length-1):b.protocol+"//"+b.host,d=c.indexOf("/",8);c=(d==-1?c:c.substring(0,d))+b.pathname,a=a?a:"";var e=new RegExp(c,"gi");if(e.test(a))showLoginFormReady=!0;else{var f=self==top?b.href:top.location.href;f=f.replace(/&/gi,"!"),top.location=a+"?cmd=logout&back=yes&referer="+f}}function execCommonUtil(a,b,c,d){if(!b||"string"!=typeof b)return void alert("Не указан путь к обработчику утилиты");var e="string"==typeof a?$(a):a;e||(e=makeForm("string"==typeof a?a:"",null,b,d&&"string"==typeof d?d:utilsIframeName,null,null,null));var g,f="";if(c&&"object"==typeof c){var h;for(h in c)"folderID"==h&&(f=c[h]),(g=e.elements[h])?g.value=c[h]:makeInput(e,"hidden",h,c[h])}var i="";if("true"==getSelectAllSelected())i="true",sendExceptionObjIds(e);else{var j=getSelObjects()[0];j&&j.length>0&&(f=j.join()),(g=e.elements.objId)?g.value=f:makeInput(e,"hidden","objId",f)}(g=e.elements.sessionParams)?g.value=i:makeInput(e,"hidden","sessionParams",i),e.submit()}var doClose=!0,doCloseItem=!0,doCloseOnNoEvent=!0,menuShowed=!1,useModalWindows=!1,currentModalWin=null,navigatorUsrAgent=navigator.userAgent.toLowerCase(),browserInfo={isIE:!1,isIE8:!1,isIE7:!1,isIE6:!1,isSafari:navigatorUsrAgent.indexOf(" applewebkit/")>-1,isOpera:!!window.opera,isAIR:navigatorUsrAgent.indexOf(" adobeair/")>-1,isMac:navigatorUsrAgent.indexOf("macintosh")>-1};!function(a){if(a.isIE8&&(a.isIE6=!1,a.isIE7=!1),a.isIE7&&(a.isIE6=!1),a.isGecko="Gecko"==navigator.product&&!a.isSafari&&!a.isOpera,a.isMoz=a.isGecko,a.isGeckoLike=a.isGecko||a.isSafari||a.isOpera,a.isGecko){var b=navigatorUsrAgent.match(/rv:(\d+\.\d+)/),c=b&&parseFloat(b[1]);c&&(a.isGecko10=c<1.8,a.isGecko19=c>1.8)}}(browserInfo);var isOpera=browserInfo.isOpera,isOpera6=navigator.appVersion.indexOf("MSIE 5")!=-1&&navigator.userAgent.indexOf("Opera 6")!=-1,isN6=browserInfo.isGecko,isN4=browserInfo.isGecko&&browserInfo.isGecko10,isMoz=browserInfo.isGecko,isMac=browserInfo.isSafari,isIE=browserInfo.isIE,winArray=new Array,winAttrArray=new Array,winClassArray=new Array,winLast=null,updateFrameFunctionArray=new Array,gridTabIndexArr=new Array,toolbarZones=new Array,baseUrl=document.getElementsByTagName("base")[0].getAttribute("href"),popupWinWidth=750,popupWinHeight=550,root=window.addEventListener||window.attachEvent?window:document.addEventListener?document:null,utilsIframeName="myTarget",dummyImgForIframe=baseUrl+"admin/images/e.gif",HashMap=function(){this.keys=new Array,this.entries={},this.length=0};if(HashMap.prototype.put=function(a,b){this.entries[a]?this.entries[a].k=b:(this.entries[a]={k:this.keys.push(a)-1,v:b},this.length++)},HashMap.prototype.get=function(a){return this.entries[a]&&this.entries[a].v},HashMap.prototype.containsKey=function(a){return!!this.entries[a]},HashMap.prototype.remove=function(a){this.entries[a]&&(delete this.keys[this.entries[a].k],delete this.entries[a],this.length--)},HashMap.prototype.clear=function(a){for(var b in this.keys)delete this.entries[this.keys[b]],delete this.keys[b];this.length=0},HashMap.prototype.getMap=function(){return this.entries},HashMap.prototype.keySet=function(){return this.keys},HashMap.prototype.size=function(){return this.length},"undefined"==typeof $)var $=function(a){return"object"==typeof a?a:document.getElementById(a)};var stopEventBuble=function(a){return getFalse(a)};String.prototype.capitalize||(String.prototype.capitalize=function(){return this.replace("/[A-Za-z0-9_а-яёА-ЯЁ]+/g",function(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()})}),Array.prototype.old_push=Array.prototype.push,Array.prototype.push=push,Array.prototype.pop=pop;var eframeName="eattrFrame",eformName="eattrForm",eattrHtml=null,isEAttrChanged=!1,currentFieldValue=null,doBlurForDate=!1,lastCalGridObject=null,eattrDateTimer=null,chooseButtonPressedForDate=!1;root&&(root.addEventListener?root.addEventListener("load",initEverything,!1):root.attachEvent&&root.attachEvent("onload",initEverything));var selectedIdArray=null,selectedTitleArray=null,exceptionIdArray=null,paramsHashCode=null,gridDataArray=null,selectAllSelected="false",selectedObjClass=null,selectCheckersName="",saveListOfChoosenObj=!1,OBJECT_MODE=0,FOLDER_MODE=1,selectMode=OBJECT_MODE,doWithAll=0,doSetAll=!1,selectedObj=null,updateToOpenerOpener=!1;