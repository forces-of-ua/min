function CreateCalendarDiv(a){var b=a||event,c=window.event?b.srcElement:b.target;if("IMG"==c.tagName||"BUTTON"==c.tagName){var d=c.parentNode,e=document.createElement("DIV");e.setAttribute("id","CalendarLayer"),e.style.position="absolute",e.style.display="none",e.style.zIndex="100","IMG"==c.tagName?d.parentNode.appendChild(e):d.appendChild(e)}}function calendarBody(a){var b="";return"top"==a?(b+='<table cellspacing="0" cellpadding="0" width="100%" class="eatr_cal"><tr><td class="cal_body">\n',b+='<table width="100%" cellpadding="0" cellspacing="0"><tr><td style="cursor:default;">',1==calendarContainer&&(b+='<iframe name="calIFrame" id="calIFrame" '+(window.setIE6iframeSrc?setIE6iframeSrc(!0):"")+' frameborder="0"></iframe>')):"bottom"==a&&(b+="</td></tr></table>",b+='</td><td><table cellpadding="0" cellspacing="0" style="height:100%"><tr><td style="font-size:4px;">&nbsp;</td></tr><tr><td class="win_bg">&nbsp;</td></tr></table></td></tr>',b+='<tr><td valign="top"><table width="100%" cellspacing="0" cellpadding="0"><tr><td style="font-size:4px;">&nbsp;</td><td class="win_vbg">&nbsp;</td></tr></table></td><td valign="top"></td></tr></table>'),b}function span1(a){return"<span class='"+a+"'>"}function spanx(a,b){return"."+a+" { font-family:"+fontFace+"; color:"+b+"; }\n"}function a1(a){return"<a class='aOff' onMouseOver=\"this.className='aOn'\" onMouseOut=\"this.className='aOff'\"  onclick="}function ax(a,b){return"."+a+" { text-decoration:none; color:"+b+"; }\n"}function calOBJ(a,b,c,d,e,f,g,h){if(void 0==c){var i=$("cal_"+b);c=i?i.form:null}else c instanceof String&&(c=document.forms[c]);null==c&&(c=document.forms[document.forms.length-1]),this.fieldPrefix=f?f:"",this.dataFieldPrefix=e?e:"",this.attrName=b,this.minYear=g?g:defaultMinYear,this.yearDelta=h?h:maxYearDelta,this.name=this.fieldPrefix+"calendar("+b+")",this.field=this.fieldPrefix+"date("+b+")",""!=this.dataFieldPrefix?this.dataField=this.dataFieldPrefix+"("+b+")":this.dataField=this.fieldPrefix+"data("+b+")",this.hhField=this.fieldPrefix+"hh("+b+")",this.mmField=this.fieldPrefix+"mm("+b+")",this.ssField=this.fieldPrefix+"ss("+b+")",this.message=d,this.title=a,c.tagName?(this.formName=c.name,this.form=c):(this.formName=c,this.form=document.forms[this.formName]),this.getFieldObj=function(a){var b=$(a);return b?b:this.form[a]};var j=this.getFieldObj(this.field);this.viewType=!j||j&&"hidden"==j.type?"time":this.getFieldObj(this.hhField)&&this.getFieldObj(this.mmField)?"datetime":"date";var k=this.getFieldObj(this.dataField);k&&""!=k.value&&(j&&(j.value=getFormatedDate(k.value,this.viewType)),"datetime"!=this.viewType&&"time"!=this.viewType||(setHour(this.getFieldObj(this.hhField),this.getFieldObj(this.dataField).value),setMinute(this.getFieldObj(this.mmField),this.getFieldObj(this.dataField).value),setSecond(this.getFieldObj(this.ssField),this.getFieldObj(this.dataField).value))),addCalendarConvertEvent(this)}function toDate(a){var b=new Date;return b.setTime(a),b}function setHour(a,b,c){a&&(a.value=c?toDate(b).getUTCHours():toDate(b).getHours())}function setMinute(a,b,c){a&&(a.value=c?toDate(b).getUTCMinutes():toDate(b).getMinutes())}function setSecond(a,b,c){a&&(a.value=c?toDate(b).getUTCSeconds():toDate(b).getSeconds())}function setFont(a,b){""!=a&&(fontFace=a),b>0&&(fontSize=b,isN4&&(fontSize+=2))}function setWidth(a,b,c,d){a>0&&(titleWidth=a),1!=b&&2!=b||(titleMode=b),c>0&&(dayWidth=c),d>0&&(dayDigits=d)}function setColor(a,b,c,d,e,f,g){""!=a&&(titleColor=a),""!=b&&(daysColor=b),""!=c&&(bodyColor=c),""!=d&&(dayColor=d),""!=e&&(currentDayColor=e),""!=f&&(footColor=f),""!=g&&(borderColor=g)}function setFontColor(a,b,c,d,e){""!=a&&(titleFontColor=a),""!=b&&(daysFontColor=b),""!=c&&(dayFontColor=c),""!=d&&(currentDayFontColor=d),""!=e&&(footFontColor=e)}function setFormat(a){calFormat=a}function setSize(a,b,c,d){a>0&&(calWidth=a),b>0&&(calHeight=b),calOffsetX=c,calOffsetY=d}function setWeekDay(a){0!=a&&1!=a||(weekDay=a)}function setMonthNames(a,b,c,d,e,f,g,h,i,j,k,l){""!=a&&(yxMonths[0]=a),""!=b&&(yxMonths[1]=b),""!=c&&(yxMonths[2]=c),""!=d&&(yxMonths[3]=d),""!=e&&(yxMonths[4]=e),""!=f&&(yxMonths[5]=f),""!=g&&(yxMonths[6]=g),""!=h&&(yxMonths[7]=h),""!=i&&(yxMonths[8]=i),""!=j&&(yxMonths[9]=j),""!=k&&(yxMonths[10]=k),""!=l&&(yxMonths[11]=l)}function setDayNames(a,b,c,d,e,f,g){""!=a&&(yxDays[0]=yxDays[7]=a),""!=b&&(yxDays[1]=b),""!=c&&(yxDays[2]=c),""!=d&&(yxDays[3]=d),""!=e&&(yxDays[4]=e),""!=f&&(yxDays[5]=f),""!=g&&(yxDays[6]=g)}function setLinkNames(a,b){""!=a&&(yxLinks[0]=a),""!=b&&(yxLinks[1]=b)}function addExistedCalendarObj(a){null!=a&&a.name.indexOf("calendar")!=-1&&(cals[cals.length]=a)}function addCalendar(a,b,c,d,e,f,g,h){var i=new calOBJ(a,b,c,d,e,f,g,h);return cals[cals.length]=i,i}function findCalendar(a){for(var b=0;b<cals.length;b++)if(cals[b].name==a)return null==cals[b].form&&(""==cals[b].formName?document.forms[0]&&(cals[b].form=document.forms[0]):document.forms[cals[b].formName]&&(cals[b].form=document.forms[cals[b].formName])),cals[b];return null}function getDayName(a,b,c){var d=new Date(a,b,c);return yxDays[d.getDay()].substring(0,3)}function getMonthFromName(a){for(var b=0;b<yxMonths.length;b++)if(yxMonths[b].toLowerCase().substring(0,3)==a.toLowerCase())return b;return 0}function getFormat(){var a=calFormat;return a=a.replace(/\\/g,"\\\\"),a=a.replace(/\//g,"\\/"),a=a.replace(/\[/g,"\\["),a=a.replace(/\]/g,"\\]"),a=a.replace(/\(/g,"\\("),a=a.replace(/\)/g,"\\)"),a=a.replace(/\{/g,"\\{"),a=a.replace(/\}/g,"\\}"),a=a.replace(/\</g,"\\<"),a=a.replace(/\>/g,"\\>"),a=a.replace(/\|/g,"\\|"),a=a.replace(/\*/g,"\\*"),a=a.replace(/\?/g,"\\?"),a=a.replace(/\+/g,"\\+"),a=a.replace(/\^/g,"\\^"),a=a.replace(/\$/g,"\\$"),a=a.replace(/dd/i,"\\d\\d"),a=a.replace(/mm/i,"\\d\\d"),a=a.replace(/yyyy/i,"\\d\\d\\d\\d"),a=a.replace(/day/i,"\\w\\w\\w"),a=a.replace(/mon/i,"\\w\\w\\w"),new RegExp(a)}function leapYear(a){return a%4==0?a%100==0?a%400==0?1:0:1:0}function checkTime(a,b){var c=a.value,d=0;switch(isNaN(parseInt(c))||(d=parseInt(c)),b){case 1:d>23&&(d=23);break;case 2:d>59&&(d=59);break;case 3:d>59&&(d=59)}c=get2Digits(d),a.value=c}function getDateNumbers(a,b){var c,d,e,f=calFormat.search(/yyyy/i),g=calFormat.search(/mm/i),h=calFormat.search(/mon/i),i=calFormat.search(/dd/i),j=a.value,k=new Date,l=k.getFullYear()+(null!=b?b.yearDelta:maxYearDelta),m=null!=b?b.minYear:defaultMinYear,n=!1,o=!1,p=!1;return c=j.substring(f,f+4)-0,(c<m||c>l)&&(n=!0,c=c<m?m:l),g!=-1?(d=j.substring(g,g+2)-0,d>12&&(o=!0),d=d>0?d<=12?d-1:11:0):d=getMonthFromName(j.substring(h,h+3)),e=j.substring(i,i+2)-0,e=e>0?e:1,e>31&&(p=!0),e>28&&(e=e>31?31:e,3!=d&&5!=d&&8!=d&&10!=d||(e=e>30?30:e),1==d&&(e=leapYear(c)?29:28)),a.value=(p?"xx":get2Digits(e))+"."+(o?"xx":get2Digits(d+1))+"."+(n?"xxxx":c),new Array(c,d,e)}function hideCal(){if(null!=calWin)calWin.close(),calWin=null;else if($("CalendarLayer")){var a=$("CalendarLayer"),b=a.parentNode;b.removeChild(a)}window.status="",resizeParent()}function getLeftIE(a,b){var c=0;return"TD"==a.tagName?c=a.offsetLeft:"TABLE"==a.tagName&&(c=a.offsetLeft,b&&(c+=""!=a.cellPadding?parseInt(a.cellPadding):2,b=!1)),c+("BODY"==a.parentElement.tagName?0:getLeftIE(a.parentElement,b))}function getTopIE(a,b){var c=0;return"TR"==a.tagName?c=a.offsetTop:"TABLE"==a.tagName&&(c=a.offsetTop,b&&(c+=""!=a.cellPadding?parseInt(a.cellPadding):2,b=!1)),c+("BODY"==a.parentElement.tagName?0:getTopIE(a.parentElement,b))}function getLeftN4(a){return a.pageX}function getTopN4(a){return a.pageY}function getLeftN6(a){return a.offsetLeft}function getTopN6(a){return a.offsetTop}function lastDay(a){for(var b=a.getFullYear(),c=a.getMonth(),d=31;d>=28;d--){var e=new Date(b,c,d);if(c==e.getMonth())return d}}function firstDay(a){var b=a.getFullYear(),c=a.getMonth(),d=new Date(b,c,1);return d.getDay()}function dayDisplay(a){return 0==dayDigits?yxDays[a]:yxDays[a].substring(0,dayDigits)}function calMakeCmd(a,b){var c="";if(null!=a&&""!=a)return null==b&&(b=""),c=$("CalendarLayer")?1==calendarContainer?"if(self.parent && self.parent."+a+") self.parent."+a+"("+b+")":a+"("+b+")":"if(window.opener && !window.opener.closed && window.opener."+a+") window.opener."+a+"("+b+")"}function calTitle(a){var b=a.getFullYear(),c=yxMonths[a.getMonth()],d="<style>span.days {font-weight:bold;font-size:11px}</style><table align='center' border='0' bgcolor='"+borderColor+"' cellspacing='0' cellpadding='1'><tr><td>\n<table cellspacing='0' cellpadding='0' border='0' class='tbody'>\n";d+=2==titleMode?"<tr align='center' bgcolor='"+titleColor+"'><td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0'><tr align='center' valign='middle'><td align='right'>"+span1("title")+"<b>&nbsp;"+a1("titlea")+"'"+calMakeCmd("moveYear","-1")+"'><img src='"+baseUrl+"images/military/arrowleft.gif' border='0'/>&nbsp;</a></b>"+span2+"</td><td width='"+titleWidth+"'><b>"+span1("title")+b+span2+"</b></td><td align='left'>"+span1("title")+"<b>"+a1("titlea")+"'"+calMakeCmd("moveYear","1")+"'>&nbsp;<img src='"+baseUrl+"images/military/arrowright.gif' border='0'/></a>&nbsp;</b>"+span2+"</td></tr><tr align='center' valign='middle'><td align='right'>"+span1("title")+"<b>"+a1("titlea")+"'"+calMakeCmd("prepMonth",a.getMonth())+"'>&nbsp;<img src='"+baseUrl+"images/military/arrowleft.gif' border='0'/>&nbsp;</a></b>"+span2+"</td><td width='"+titleWidth+"'><b>"+span1("title")+c+span2+"</b></td><td align='left'>"+span1("title")+"<b>"+a1("titlea")+"'"+calMakeCmd("nextMonth",a.getMonth())+"'>&nbsp;<img src='"+baseUrl+"images/military/arrowright.gif' border='0'/>&nbsp;</a></b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>":"<tr align='center' bgcolor='"+titleColor+"'><td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0' ><tr align='center' valign='middle'><td>"+span1("title")+"<b>"+a1("titlea")+"'"+calMakeCmd("moveYear","-1")+"'>&nbsp;&lt;&lt;</a>&nbsp;"+a1("titlea")+"'"+calMakeCmd("prepMonth",a.getMonth())+"'><img src='"+baseUrl+"images/military/arrowleft.gif' border='0'/>&nbsp;</a></b>"+span2+"</td><td style='font-size:14px !important;' width='"+titleWidth+"'><b>"+span1("title")+c+"<br/>"+b+span2+"</b></td><td>"+span1("title")+"<b>"+a1("titlea")+"'"+calMakeCmd("nextMonth",a.getMonth())+"'>&nbsp;<img src='"+baseUrl+"images/military/arrowright.gif' border='0'/></a>&nbsp;"+a1("titlea")+"'"+calMakeCmd("moveYear","1")+"'>&gt;&gt;&nbsp;</a></b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>";for(var e=weekDay;e<weekDay+7;e++)d+="<td style='border-bottom:1px solid #000000' width='"+dayWidth+"'>"+span1("days")+dayDisplay(e)+span2+"</td>";return d+="</tr>\n"}function calStyle(){return"<style type='text/css'>\n .aOn {border:3px solid #e16937;cursor:pointer; padding:3px;font-size:"+fontSize+"px; }\n .aOff {padding:3px;border:3px solid #ffffff;cursor:pointer;font-size:"+fontSize+"px;}\n"+spanx("title",titleFontColor)+spanx("days",daysFontColor)+spanx("foot",footColor)+spanx("day",dayFontColor)+spanx("currentDay",currentDayFontColor)+ax("titlea",titleFontColor)+ax("daya",dayFontColor)+ax("currenta",currentDayFontColor)+ax("foota",footFontColor)+"span.title .aOn,span.title  .aOff,span.foot .aOn,span.foot  .aOff{border:0px !important; padding:0px !important; color:#252525;} .tbody {background:#FFFFFF}</style>\n"}function calHeader(){return"<head>\n<title>"+currentCal.title+"</title>\n</head>\n<body style='margin:0px;overflow:hidden;cursor:default;'>\n"}function calFooter(){return"<tr bgcolor='"+footColor+"'><td colspan='7' align='center'>"+span1("foot")+"<b>"+a1("foota")+"'"+calMakeCmd("hideCal")+"'>"+yxLinks[0]+"</a>&nbsp;&nbsp;"+a1("foota")+"'"+calMakeCmd("clearDate")+"'>"+yxLinks[1]+"</a></b>"+span2+"</td></tr></table>\n</td></tr></table>\n"}function calBody(a,b){var c="",d=1,e=firstDay(a),f=lastDay(a);weekDay>0&&0==e&&(e=7);for(var g=0;g<6;g++){c+="<tr align='center' bgcolor='"+bodyColor+"'>";for(var h=weekDay;h<weekDay+7;h++)if(7*g+h<e||d>f)c+="<td style='background:#FFFFFF; padding:6px 0'>"+span1("day")+"&nbsp;"+span2+"</td>";else{var i=dayColor,j="day",k="daya";d==b&&(i=currentDayColor,j="currentDay",k="currenta"),c+="<td style='padding:6px 0' bgcolor='"+i+"'>"+span1(j)+a1(k)+"'"+calMakeCmd("pickDate",d)+"'>"+d++ +"</a>"+span2+"</td>"}c+="</tr>"}return c}function moveYear(a){cY+=a;var b=new Date(cY,cM,1);changeCal(b)}function prepMonth(a){cM=a-1,cM<0&&(cM=11,cY--);var b=new Date(cY,cM,1);changeCal(b)}function nextMonth(a){cM=a+1,cM>11&&(cM=0,cY++);var b=new Date(cY,cM,1);changeCal(b)}function changeCal(a){var b=0;if(null!=currentCal){var f,c=getFormat(),d=currentCal.getFieldObj(currentCal.field),e=currentCal.getFieldObj(currentCal.dataField);""!=d.value&&c.test(d.value)?(f=getDateNumbers(d,currentCal),f[0]==a.getFullYear()&&f[1]==a.getMonth()&&(b=f[2])):""!=e.value?(f=new Date,f.setTime(e.value),f.getFullYear()==a.getFullYear()&&f.getMonth()==a.getMonth()&&(b=f.getDate())):(f=new Date,f.getFullYear()==a.getFullYear()&&f.getMonth()==a.getMonth()&&(b=f.getDate()))}var g,h=$("CalendarLayer");null!=h?0==calendarContainer?(g=calStyle()+calTitle(a)+calBody(a,b)+calFooter(),h.innerHTML=calendarBody("top")+g+calendarBody("bottom")):(g=calHeader()+calStyle()+calTitle(a)+calBody(a,b)+calFooter()+"</body>",null!=$("calIFrame")&&(isIE||isOpera6?(document.frames("calIFrame").document.open(),document.frames("calIFrame").document.write(g),document.frames("calIFrame").document.close()):($("calIFrame").contentDocument.open(),$("calIFrame").contentDocument.write(g),$("calIFrame").contentDocument.close()),h.style.width=calWidth,h.style.height=calHeight,$("calIFrame").style.height=calHeight,$("calIFrame").style.width=calWidth)):(g=calHeader()+calStyle()+calTitle(a)+calBody(a,b)+calFooter()+"</body>",calWin.document.open(),calWin.document.write(g),calWin.document.close())}function markClick(a){var b=window.event?window.event:a;return null!=$("CalendarLayer")&&hideCal(),CreateCalendarDiv(b),winX=b.screenX,winY=b.screenY,stopEvent(a),!0}function showCal(a,b,c){var d=window.event?window.event:c;b||(b=""),a=b+"calendar("+a+")";var e=currentCal,f=new Date,g=!1;if(currentCal=findCalendar(a),null==$("CalendarLayer")||(hideCal(),null==e||e.name!=a))if(markClick(d),null!=currentCal&&null!=currentCal.form&&currentCal.getFieldObj(currentCal.field)){var h=getFormat(),i=currentCal.getFieldObj(currentCal.field),j=currentCal.getFieldObj(currentCal.dataField);if(""!=i.value&&h.test(i.value)){var k=getDateNumbers(i,currentCal);f=new Date(k[0],k[1],k[2]),cY=k[0],cM=k[1],dd=k[2]}else""!=j.value?(f=new Date,f.setTime(j.value),cY=f.getFullYear(),cM=f.getMonth(),dd=f.getDate()):(cY=f.getFullYear(),cM=f.getMonth(),dd=f.getDate());var l,m=$("CalendarLayer");null!=m?0==calendarContainer?(l=calStyle()+calTitle(f)+calBody(f,dd)+calFooter(),m.innerHTML=calendarBody("top")+l+calendarBody("bottom"),m.style.width=calWidth+"px",m.style.height=calHeight+"px",m.style.display=""):(l=calHeader()+calStyle()+calTitle(f)+calBody(f,dd)+calFooter()+"</body>",m.innerHTML=calendarBody("top")+calendarBody("bottom"),null!=document.getElementById("calIFrame")&&(isIE||isOpera6?(document.frames.calIFrame.document.open(),document.frames.calIFrame.document.write(l),document.frames.calIFrame.document.close()):($("calIFrame").contentDocument.open(),$("calIFrame").contentDocument.write(l),$("calIFrame").contentDocument.close()),m.style.width=calWidth+"px",m.style.height=calHeight+"px",$("calIFrame").style.height=calHeight+"px",$("calIFrame").style.width=calWidth+"px",m.style.display=""),(winX+calWidth>document.body.clientWidth||winY+calHeight>document.body.clientHeight)&&resizeParent()):(l=calHeader()+calStyle()+calTitle(f)+calBody(f,dd)+calFooter()+"</body>",null==calWin||calWin.closed||(g=!0,calWin.moveTo(winX+calOffsetX,winY+calOffsetY)),g||(calWin=isIE||isOpera6?window.open("","cal","toolbar=0,width="+calWidth+",height="+calHeight+",left="+(winX+calOffsetX)+",top="+(winY+calOffsetY)):window.open("","cal","toolbar=0,width="+calWidth+",height="+calHeight+",screenx="+(winX+calOffsetX)+",screeny="+(winY+calOffsetY))),calWin.document.open(),calWin.document.write(l),calWin.document.close(),calWin.focus())}else null==currentCal?window.status="Calendar ["+a+"] not found.":currentCal.form?currentCal.getFieldObj(currentCal.field)||(window.status="Form Field ["+currentCal.formName+"."+currentCal.field+"] not found."):window.status="Form ["+currentCal.formName+"] not found.",null!=e&&(currentCal=e)}function get2Digits(a){return(a<10?"0":"")+a}function clearDate(){var a=currentCal.getFieldObj(currentCal.field);a.value="",findHidden(a.form,0,a).value="",hideCal()}function findFormbyFieldName(a){for(var b=null,c=document.forms.length,d=0;d<c;d++)if(null!=document.forms[d].elements[a]){b=document.forms[d];break}return b}function clearDateField(a,b){if(null!=a){b||(b="");var c=b+"calendar("+a+")";if(currentCal=findCalendar(c),currentCal&&currentCal.form){var d=currentCal.getFieldObj(currentCal.field);d&&(d.value="",null!=d.onchange&&d.onchange()),d=currentCal.getFieldObj(currentCal.dataField),d&&(d.value=""),d=currentCal.getFieldObj(currentCal.hhField),d&&(d.value=""),d=currentCal.getFieldObj(currentCal.mmField),d&&(d.value=""),d=currentCal.getFieldObj(currentCal.ssField),d&&(d.value="")}}}function pickDate(a){hideCal(),window.focus();var b=calFormat;b=b.replace(/yyyy/i,cY),b=b.replace(/mm/i,get2Digits(cM+1)),b=b.replace(/MON/,yxMonths[cM].substring(0,3).toUpperCase()),b=b.replace(/Mon/i,yxMonths[cM].substring(0,3)),b=b.replace(/dd/i,get2Digits(a)),b=b.replace(/DAY/,getDayName(cY,cM,a).toUpperCase()),b=b.replace(/day/i,getDayName(cY,cM,a));var c=currentCal.getFieldObj(currentCal.field),d=currentCal.getFieldObj(currentCal.dataField);c.value=b,c.blur(),null!=d.onchange?d.onchange():(c.focus(),c.focus()),self.setChanged&&setChanged()}function checkDate(a){var b=findCalendar(a);if(null!=b&&null!=b.form&&b.getFieldObj(b.field)){var c=getFormat();return c.test(b.getFieldObj(b.field).value)?0:1}return 2}function getCurrentDate(){var a=calFormat,b=new Date;return a=a.replace(/yyyy/i,b.getFullYear()),a=a.replace(/mm/i,get2Digits(b.getMonth()+1)),a=a.replace(/dd/i,get2Digits(b.getDate()))}function compareDates(a,b){var d,e,c=getFormat();d=getNumbers(c.test(a)?a:getCurrentDate()),e=getNumbers(c.test(b)?b:getCurrentDate());var f=d[0]+""+d[1]+d[2],g=e[0]+""+e[1]+e[2];return f==g?0:f>g?1:-1}function getNumbers(a){var c,d,e,b=getFormat();if(b.test(a)){var f=calFormat.search(/yyyy/i),g=calFormat.search(/mm/i),h=calFormat.search(/mon/i),i=calFormat.search(/dd/i);if(c=a.substring(f,f+4),g!=-1)d=a.substring(g,g+2);else{var j=getMonthFromName(a.substring(h,h+3))+1;d=j<10?"0"+j:""+j}return e=a.substring(i,i+2),new Array(c,d,e)}return new Array("","","")}function getFormatedDate(a,b){var c=calFormat,d=new Date;a&&d.setTime(a);var e=d.getFullYear(),f=d.getMonth(),g=d.getDate();return c=c.replace(/yyyy/i,e),c=c.replace(/mm/i,get2Digits(f+1)),c=c.replace(/MON/,yxMonths[f].substring(0,3).toUpperCase()),c=c.replace(/Mon/i,yxMonths[f].substring(0,3)),c=c.replace(/dd/i,get2Digits(g)),c=c.replace(/DAY/,getDayName(e,f,g).toUpperCase()),c=c.replace(/day/i,getDayName(e,f,g))}function collectEvent(a){var b="";if(!a)return b;if(!a.getAttribute)return b;var c=a.getAttribute("onblur");return null!=c&&(c+=" ",b=window.attachEvent?c.substring(c.indexOf("{")+1,c.indexOf("}")-1):c),b}function bindOnblurEvent(obj,handler){obj&&(obj.addEventListener?obj.onblur=function(event){eval(handler)}:obj.onblur=new Function(handler))}function addCalendarConvertEvent(a){var c,d,b="calendarConvert('"+a.name+"')";c=a.getFieldObj(a.field),c&&(d=b+";"+collectEvent(c),bindOnblurEvent(c,d),c.addEventListener?c.addEventListener("keyup",checkHitEnter,!1):c.attachEvent&&c.attachEvent("onkeyup",checkHitEnter)),c=a.getFieldObj(a.hhField),c&&(d=b+";"+collectEvent(c),bindOnblurEvent(c,d)),c=a.getFieldObj(a.mmField),c&&(d=b+";"+collectEvent(c),bindOnblurEvent(c,d)),c=a.getFieldObj(a.ssField),c&&(d=b+";"+collectEvent(c),bindOnblurEvent(c,d))}function calendarConvert(a){var b=findCalendar(a);if(!b)return alert(errMess.replace(/\{1\}/,a)),!1;var c=getFormat(),d=b.viewType,e=b.getFieldObj(b.hhField),f=b.getFieldObj(b.mmField),g=b.getFieldObj(b.ssField),h=e&&""!=e.value,i=f&&""!=f.value,j=g&&""!=g.value,k=null,l=b.getFieldObj(b.field),m=b.getFieldObj(b.dataField);if(l&&""!=l.value&&c.test(l.value)){var n=getDateNumbers(l,b);if(l.value==l.getAttribute("mask")||""==l.value)return alert(b.message),!1;k=new Date(n[0],n[1],n[2])}else(h||i||j)&&(k=new Date);return null!=k?("date"==d?(k.setHours("0"),k.setMinutes("0"),k.setSeconds("0")):(k.setHours(h?e.value:"0"),k.setMinutes(i?f.value:"0"),k.setSeconds(j?g.value:"0")),isNaN(k)?(alert(b.message),!1):("date"!=d?(m.value=Date.UTC(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate(),k.getUTCHours(),k.getUTCMinutes(),k.getUTCSeconds()),k=new Date(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate(),k.getUTCHours(),k.getUTCMinutes(),k.getUTCSeconds())):m.value=Date.UTC(k.getFullYear(),k.getMonth(),k.getDate(),k.getHours(),k.getMinutes(),k.getSeconds()),null!=m.onchange&&m.onchange(),!0)):(m&&(m.value=""),!0)}function stopEvent(a){var b=window.event?window.event:a;b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation()}function setDatetoHidden(a,b,c,d){if(null!=a){var e=a.form;if(null!=e){var f=$(b);if(f||(f=e.elements[b]),null!=f)if(a.getAttribute("inline")&&self.hideMessageContainer&&hideMessageContainer(a),a.value.toLowerCase().indexOf("x")!=-1||""==a.value){if(f.value="",a.value==a.getAttribute("mask")||""==a.value)return a.value="",a.removeAttribute("error"),void alert(f.value);var g=a.getAttribute("maskMessage");if(g||(g=c),a.getAttribute("inline")&&self.getMessageContainer){var h=getMessageContainer(a,g,null);h.style.display=""}else alert(g);a.setAttribute("error",g),d||(a.value="")}else a.removeAttribute("error")}}}function fullfillDate(a){var b,c,d,e=calFormat.search(/yyyy/i),f=calFormat.search(/mm/i),g=calFormat.search(/mon/i),h=calFormat.search(/dd/i),i=a.value,j=new Date;if(b=i.substring(e,e+4),b.indexOf("x")!=-1){var k=b.substring(0,2);if("xx"==k)b=j.getFullYear();else{var l=parseInt(k);b=isNaN(l)?j.getFullYear():l<20?"20"+k:"19"+k}}f!=-1?(c=i.substring(f,f+2),c=c.indexOf("x")==-1?c:j.getMonth()+1):c=getMonthFromName(i.substring(g,g+3)),d=i.substring(h,h+2),d=d.indexOf("x")==-1?d:j.getDate(),a.value=get2Digits(d-0)+"."+(c.length>2?c:get2Digits(c-0))+"."+b}function checkHitEnter(a){var b=window.event?window.event:a,c=window.event?b.srcElement:b.target;return 13!=b.keyCode||void fullfillDate(c)}function setCalendarHideEvent(){var a=document.body;a&&(a.addEventListener&&a.addEventListener("click",markClick,!1),a.attachEvent&&a.attachEvent("onclick",markClick))}function findHidden(a,b,c){if(null==a||"form"!=a.tagName.toLowerCase())return null;var d=null;if(null!=c){var e=c.getAttribute("hidElem");if(d=null!=e?a.elements[e]:null,null!=d)return d}for(var f=0;f<a.elements.length;f++)if("hidden"==a.elements[f].type&&a.elements[f].name.indexOf(b)!=-1){d=a.elements[f];break}return d}function getDateMS(a,b){if(null==a)return!1;var c=new Date(new Number(a.value));return"NaN"==c&&(calendarConvert("calendar("+b+")"),c=new Date(new Number(a.value))),c.valueOf()}function compareTwoDates(a,b,c){var d=!0;if(null==a)return d;var e=a.tagName&&"form"==a.tagName.toLowerCase()?a:a.form;if(null==e)return d;if(null!=c){if(o1=e.elements[b],o2=e.elements[c],null==o1||null==o2)return d;n1=o1.getAttribute("name"),n1=n1.substring(n1.indexOf("(")+1,n1.lastIndexOf(")")),n2=o2.getAttribute("name"),n2=n2.substring(n2.indexOf("(")+1,n2.lastIndexOf(")"))}else{var f=a.getAttribute("alias");if(null==f||null!=f&&""==trim(f))return d;if(f.lastIndexOf("_till")!=-1){if(alias1=f.substr(0,f.lastIndexOf("_till"))+"_from",o1=getObjectByAttr(e,"input","alias",alias1,1)[0],null==o1)return d;n1=o1.getAttribute("name"),n1=n1.substring(n1.indexOf("(")+1,n1.lastIndexOf(")")),b||(b=a.getAttribute("name"),b=b.substring(b.indexOf("(")+1,b.lastIndexOf(")"))),o2=a,n2=b}else{if(f.lastIndexOf("_from")==-1)return d;if(alias2=f.substr(0,f.lastIndexOf("_from"))+"_till",o2=getObjectByAttr(e,"input","alias",alias2,1)[0],null==o2)return d;n2=o2.getAttribute("name"),n2=n2.substring(n2.indexOf("(")+1,n2.lastIndexOf(")")),b||(b=a.getAttribute("name"),b=b.substring(b.indexOf("(")+1,b.lastIndexOf(")"))),o1=a,n1=b}}if(""==o1.value||""==o2.value)return o1.style.border.indexOf("red")!=-1&&(o1.style.border=commonBorderColor,o1.removeAttribute("error")),o2.style.border.indexOf("red")!=-1&&(o2.style.border=commonBorderColor),d;var g=getDateMS(findHidden(e,n1,o1),n1),h=getDateMS(findHidden(e,n2,o2),n2);return compareDateValues(o1,g,h,null,o2)}function compareDateWithDate(a,b,c){var d=!0;if(null==a||!a.tagName||"input"!=a.tagName.toLowerCase())return d;if(""==a.value)return a.style.border.indexOf("red")!=-1&&(a.style.border=commonBorderColor),d;var e=a.getAttribute("name");e=e.substring(e.indexOf("(")+1,e.lastIndexOf(")"));var f=null!=c?new Date(new Number(c)):new Date;"NaN"==f&&(f=new Date);var g=getDateMS(findHidden(a.form,e,a),e),h=f.getTime();return compareDateValues(a,g,h,b)}function compareDateValues(a,b,c,d,e){if(!a||!a.tagName)return!0;if(!b||!c)return!0;if(d=d&&""!=d?d:mess2User,b>c){if(a.style.border=errBorderColor,e&&e.tagName&&(e.style.border=errBorderColor),self.getMessageContainer&&a.getAttribute("inline")){var f=getMessageContainer(a,d,null);f.style.display=""}else alert(d);return a.setAttribute("error",d),!1}return a.style.border=commonBorderColor,self.hideMessageContainer&&a.getAttribute("inline")&&hideMessageContainer(a),e&&e.tagName&&(e.style.border=commonBorderColor),a.removeAttribute("error"),!0}function resizeParent(){self.resize&&self.resize()}var errFontColor="undefined"!=typeof errFontColor?errFontColor:"red",commonFontColor="undefined"!=typeof commonFontColor?commonFontColor:"black",errBorderColor="undefined"!=typeof errBorderColor?errBorderColor:"1px solid "+errFontColor,commonBorderColor="undefined"!=typeof commonBorderColor?commonBorderColor:"1px double buttonshadow",fontFace="verdana",fontSize=11,titleWidth=90,titleMode=2,dayWidth=12,dayDigits=2,titleColor="#979797",daysColor="#979797",bodyColor="#ffffff",dayColor="#ffffff",currentDayColor="#ffffff",footColor="#979797",borderColor="#252525",titleFontColor="#252525",daysFontColor="#252525",dayFontColor="#252525",currentDayFontColor="#e16937",footFontColor="#252525",calFormat="dd.mm.yyyy",maxYearDelta=100,calendarContainer=1,defaultMinYear=1900,weekDay=1;if("undefined"==typeof baseUrl)var baseUrl=document.getElementsByTagName("base")[0].getAttribute("href");var yxMonths,yxDays,yxLinks,errMess,mess2User;"object"==typeof calMessages?(yxMonths=calMessages.months,yxDays=calMessages.weeekdays,yxLinks=calMessages.buttons,errMess=calMessages.notFoundError,mess2User=calMessages.checkDatesInputs):(yxMonths=new Array("Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"),yxDays=new Array("вс","пн","вт","ср","чт","пт","сб","вс"),yxLinks=new Array("[закрыть]","[очистить]"),errMess="Не найден календарь с именем: ",mess2User="Пожалуйста, проверьте правильность введения дат!");var calWidth=184,calHeight=223,calOffsetX=-184,calOffsetY=28;if(null==CalendarLoadFlag)var calWin=null,winX=0,winY=0,cal="cal",cals=new Array,currentCal=null;var isOpera=navigator.userAgent.indexOf("Opera")!=-1,isOpera6=navigator.appVersion.indexOf("MSIE 5")!=-1&&navigator.userAgent.indexOf("Opera 6")!=-1,isN6=navigator.userAgent.indexOf("Gecko")!=-1,isN4=!!document.layers,isMac=navigator.userAgent.indexOf("Mac")!=-1,isIE=!(!document.all||isOpera||isMac&&navigator.appVersion.indexOf("MSIE 4")!=-1);isN4&&(fontSize+=2);var span2="</span>",root=window.addEventListener||window.attachEvent?window:document.addEventListener?document:null;if(root&&(root.addEventListener?root.addEventListener("load",setCalendarHideEvent,!1):root.attachEvent&&root.attachEvent("onload",setCalendarHideEvent)),null==CalendarLoadFlag)var CalendarLoadFlag=!0;